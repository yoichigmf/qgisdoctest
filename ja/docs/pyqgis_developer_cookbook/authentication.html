<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14. 認証インフラストラクチャ &mdash; QGIS Documentation  ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/qgis_docs.css?v=5415a924" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />

  
    <link rel="shortcut icon" href="../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/pyqgis_developer_cookbook/authentication.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=c033477b"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../_static/translations.js?v=4dbe4bdc"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="15. タスク - バックグラウンドで重い仕事をする" href="tasks.html" />
    <link rel="prev" title="13. ユーザーとコミュニケーションする" href="communicating.html" />
  <meta name="description" content="QGIS 3.34 documentation: 14. 認証インフラストラクチャ">
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   

          
          
          <a href="../index.html" class="icon icon-home">
            QGIS Documentation
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.34
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ユーザ向け</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/index.html">QGIS Desktopユーザーガイド／マニュアル (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_manual/index.html">QGIS Serverガイド／マニュアル (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training_manual/index.html">トレーニングマニュアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gentle_gis_introduction/index.html">やさしい GIS 入門</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ドキュメント執筆者向け</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation_guidelines/index.html">ドキュメント作成のガイドライン</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">開発者向け</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PyQGISクックブック (QGIS 3.34)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">1. はじめに</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadproject.html">2. プロジェクトをロードする</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadlayer.html">3. レイヤをロードする</a></li>
<li class="toctree-l2"><a class="reference internal" href="legend.html">4. 目次（TOC）へのアクセス</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster.html">5. ラスタレイヤを使う</a></li>
<li class="toctree-l2"><a class="reference internal" href="vector.html">6. ベクタレイヤを使う</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">7. ジオメトリの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="crs.html">8. 投影法サポート</a></li>
<li class="toctree-l2"><a class="reference internal" href="canvas.html">9. マップキャンバスを使う</a></li>
<li class="toctree-l2"><a class="reference internal" href="composer.html">10. 地図のレンダリングと印刷</a></li>
<li class="toctree-l2"><a class="reference internal" href="expressions.html">11. 式、フィルタ適用および値の算出</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">12. 設定の読み込みと保存</a></li>
<li class="toctree-l2"><a class="reference internal" href="communicating.html">13. ユーザーとコミュニケーションする</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">14. 認証インフラストラクチャ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">14.1. 前書き</a></li>
<li class="toctree-l3"><a class="reference internal" href="#glossary">14.2. 用語集</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qgsauthmanager-the-entry-point">14.3. エントリポイントQgsAuthManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#init-the-manager-and-set-the-master-password">14.3.1. マネージャを初期化し、マスターパスワードを設定する</a></li>
<li class="toctree-l4"><a class="reference internal" href="#populate-authdb-with-a-new-authentication-configuration-entry">14.3.2. 認証データベースに新しい認証構成項目を設定する</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-an-entry-from-authdb">14.3.3. authdbからエントリを削除する</a></li>
<li class="toctree-l4"><a class="reference internal" href="#leave-authcfg-expansion-to-qgsauthmanager">14.3.4. QgsAuthManagerにauthcfg展開を残す</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adapt-plugins-to-use-authentication-infrastructure">14.4. 認証インフラストラクチャを使用するようにプラグインを適応させる</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authentication-guis">14.5. 認証のGUI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gui-to-select-credentials">14.5.1. 資格情報を選択するためのGUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authentication-editor-gui">14.5.2. 認証エディタのGUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authorities-editor-gui">14.5.3. 認証局エディタのGUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">15. タスク - バックグラウンドで重い仕事をする</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/index.html">16. Pythonプラグインを開発する</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing.html">17. プロセシングプラグインを書く</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginlayer.html">18. プラグインレイヤを使う</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html">19. ネットワーク分析ライブラリ</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.html">20. QGIS ServerとPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheat_sheet.html">21. PyQGISチートシート</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/index.html">開発者ガイド</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">PyQGIS 開発者用 Cookbook</a></li>
      <li class="breadcrumb-item active"><span class="section-number">14. </span>認証インフラストラクチャ</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/pyqgis_developer_cookbook/authentication.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="communicating.html" class="btn btn-neutral float-left" title="13. ユーザーとコミュニケーションする" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tasks.html" class="btn btn-neutral float-right" title="15. タスク - バックグラウンドで重い仕事をする" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <blockquote>
<div><div class="admonition important">
<p class="admonition-title">重要</p>
<p>翻訳は <a class="reference external" href="https://qgis.org/en/site/getinvolved/translate.html#becoming-a-translator">あなたが参加できる</a> コミュニティの取り組みです。このページは現在 97.44% 翻訳されています。</p>
</div>
</div></blockquote>
<section id="authentication-infrastructure">
<span id="index-0"></span><span id="id1"></span><h1><span class="section-number">14. </span>認証インフラストラクチャ<a class="headerlink" href="#authentication-infrastructure" title="Link to this heading"></a></h1>
<div class="admonition hint">
<p class="admonition-title">ヒント</p>
<p>pyqgisコンソールを使わない場合、このページにあるコードスニペットは次のインポートが必要です:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 2</span>  <span class="n">QgsApplication</span><span class="p">,</span>
<span class="linenos"> 3</span>  <span class="n">QgsRasterLayer</span><span class="p">,</span>
<span class="linenos"> 4</span>  <span class="n">QgsAuthMethodConfig</span><span class="p">,</span>
<span class="linenos"> 5</span>  <span class="n">QgsDataSourceUri</span><span class="p">,</span>
<span class="linenos"> 6</span>  <span class="n">QgsPkiBundle</span><span class="p">,</span>
<span class="linenos"> 7</span>  <span class="n">QgsMessageLog</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kn">from</span> <span class="nn">qgis.gui</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos">11</span>    <span class="n">QgsAuthAuthoritiesEditor</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="n">QgsAuthConfigEditor</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="n">QgsAuthConfigSelect</span><span class="p">,</span>
<span class="linenos">14</span>    <span class="n">QgsAuthSettingsWidget</span><span class="p">,</span>
<span class="linenos">15</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="kn">from</span> <span class="nn">qgis.PyQt.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos">18</span>    <span class="n">QWidget</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">QTabWidget</span><span class="p">,</span>
<span class="linenos">20</span><span class="p">)</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="kn">from</span> <span class="nn">qgis.PyQt.QtNetwork</span> <span class="kn">import</span> <span class="n">QSslCertificate</span>
</pre></div>
</div>
</div>
<nav class="contents local" id="id2">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id12">前書き</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id13">用語集</a></p></li>
<li><p><a class="reference internal" href="#qgsauthmanager-the-entry-point" id="id14">エントリポイントQgsAuthManager</a></p>
<ul>
<li><p><a class="reference internal" href="#init-the-manager-and-set-the-master-password" id="id15">マネージャを初期化し、マスターパスワードを設定する</a></p></li>
<li><p><a class="reference internal" href="#populate-authdb-with-a-new-authentication-configuration-entry" id="id16">認証データベースに新しい認証構成項目を設定する</a></p>
<ul>
<li><p><a class="reference internal" href="#available-authentication-methods" id="id17">利用可能な認証方法</a></p></li>
<li><p><a class="reference internal" href="#populate-authorities" id="id18">認証局の導入</a></p></li>
<li><p><a class="reference internal" href="#manage-pki-bundles-with-qgspkibundle" id="id19">QgsPkiBundleでPKIバンドルを管理する</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#remove-an-entry-from-authdb" id="id20">authdbからエントリを削除する</a></p></li>
<li><p><a class="reference internal" href="#leave-authcfg-expansion-to-qgsauthmanager" id="id21">QgsAuthManagerにauthcfg展開を残す</a></p>
<ul>
<li><p><a class="reference internal" href="#pki-examples-with-other-data-providers" id="id22">他のデータプロバイダーとPKIの例</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#adapt-plugins-to-use-authentication-infrastructure" id="id23">認証インフラストラクチャを使用するようにプラグインを適応させる</a></p></li>
<li><p><a class="reference internal" href="#authentication-guis" id="id24">認証のGUI</a></p>
<ul>
<li><p><a class="reference internal" href="#gui-to-select-credentials" id="id25">資格情報を選択するためのGUI</a></p></li>
<li><p><a class="reference internal" href="#authentication-editor-gui" id="id26">認証エディタのGUI</a></p></li>
<li><p><a class="reference internal" href="#authorities-editor-gui" id="id27">認証局エディタのGUI</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<span id="authentication-introduction"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">14.1. </span>前書き</a><a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>認証基盤のユーザーリファレンスはユーザーマニュアル中で <a class="reference internal" href="../user_manual/auth_system/auth_overview.html#authentication-overview"><span class="std std-ref">認証システムの概要</span></a> 段落を参照して下さい。</p>
<p>この章では、開発者の観点から、認証システムを使用するベストプラクティスについて説明します。</p>
<p>認証システムは、例えばレイヤがPostgresデータベースへの接続を確立するときなど、特定のリソースへのアクセスに認証情報が必要なときにデータプロバイダーによってQGIS Desktopで広く使用されています。</p>
<p>また、QGISのguiライブラリには、プラグイン開発者が認証インフラをコードに簡単に統合するために使用できるウィジェットがいくつか用意されています:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigEditor.html#qgis.gui.QgsAuthConfigEditor" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigEditor</span></code></a></p></li>
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigSelect.html#qgis.gui.QgsAuthConfigSelect" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigSelect</span></code></a></p></li>
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthSettingsWidget.html#qgis.gui.QgsAuthSettingsWidget" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthSettingsWidget</span></code></a></p></li>
</ul>
<p>良いコードリファレンスは、認証基盤 <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_qgsauthsystem.py">tests code</a> から読むことができます。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>認証基盤の設計時に考慮されたセキュリティ上の制約により、内部メソッドの選択されたサブセットのみがPythonに公開されます。</p>
</div>
</section>
<section id="glossary">
<span id="authentication-manager-glossary"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">14.2. </span>用語集</a><a class="headerlink" href="#glossary" title="Link to this heading"></a></h2>
<p>これはこの章で扱われる最も一般的なオブジェクトのいくつかの定義です。</p>
<dl class="simple glossary">
<dt id="term-Master-Password">マスターパスワード<a class="headerlink" href="#term-Master-Password" title="Link to this term"></a></dt><dd><p>アクセスを許可し、QGIS認証DBに保存された資格情報を復号化するパスワードです</p>
</dd>
<dt id="term-Authentication-Database">認証データベース<a class="headerlink" href="#term-Authentication-Database" title="Link to this term"></a></dt><dd><p>A <a class="reference internal" href="#term-Master-Password"><span class="xref std std-term">Master Password</span></a> crypted sqlite db <code class="file docutils literal notranslate"><span class="pre">qgis-auth.db</span></code>
where <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> are stored. e.g user/password,
personal certificates and keys, Certificate Authorities</p>
</dd>
<dt id="term-Authentication-DB">認証DB<a class="headerlink" href="#term-Authentication-DB" title="Link to this term"></a></dt><dd><p><a class="reference internal" href="#term-Authentication-Database"><span class="xref std std-term">認証データベース</span></a></p>
</dd>
<dt id="term-Authentication-Configuration">認証の設定<a class="headerlink" href="#term-Authentication-Configuration" title="Link to this term"></a></dt><dd><p>認証データの構成は <span class="xref std std-term">認証メソッド</span> によって異なります。例えばベーシック認証の場合は、ユーザー/パスワードの対が格納されます。</p>
</dd>
<dt id="term-Authentication-Config">認証設定<a class="headerlink" href="#term-Authentication-Config" title="Link to this term"></a></dt><dd><p><a class="reference internal" href="#term-Authentication-Config"><span class="xref std std-term">認証設定</span></a></p>
</dd>
<dt id="term-Authentication-Method">認証方法<a class="headerlink" href="#term-Authentication-Method" title="Link to this term"></a></dt><dd><p>認証されるためには特別な方法が利用されています。各方法は、認証されるためにそれぞれ独自のプロトコルを利用しています。それぞれの方法は共有ライブラリとしてQGIS認証基盤の初期化中に動的にロードされるように実装されています。</p>
</dd>
</dl>
</section>
<section id="qgsauthmanager-the-entry-point">
<span id="id3"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">14.3. </span>エントリポイントQgsAuthManager</a><a class="headerlink" href="#qgsauthmanager-the-entry-point" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthManager</span></code></a> シングルトンは、QGISの暗号化された <a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a> （アクティブな <a class="reference internal" href="../user_manual/introduction/qgis_configuration.html#user-profiles"><span class="std std-ref">user profile</span></a> フォルダー下の <code class="file docutils literal notranslate"><span class="pre">qgis-auth.db</span></code> ファイル）に格納されている認証情報を使用するエントリポイントです。</p>
<p>このクラスは、マスターパスワードの設定を求めたり、暗号化された保存情報にアクセスするためにマスターパスワードを透過的に使用したりすることで、ユーザーとの対話を行います。</p>
<section id="init-the-manager-and-set-the-master-password">
<span id="init-manager-and-set-master-password"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">14.3.1. </span>マネージャを初期化し、マスターパスワードを設定する</a><a class="headerlink" href="#init-the-manager-and-set-the-master-password" title="Link to this heading"></a></h3>
<p>次のコード例は、認証設定へのアクセスを開くために、マスターパスワードを設定する例を示します。コードのコメントは、このコード例を理解するために重要です。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># check if QgsAuthManager has already been initialized... a side effect</span>
<span class="linenos"> 4</span><span class="c1"># of the QgsAuthManager.init() is that AuthDbPath is set.</span>
<span class="linenos"> 5</span><span class="c1"># QgsAuthManager.init() is executed during QGIS application init and hence</span>
<span class="linenos"> 6</span><span class="c1"># you do not normally need to call it directly.</span>
<span class="linenos"> 7</span><span class="k">if</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">authenticationDatabasePath</span><span class="p">():</span>
<span class="linenos"> 8</span>    <span class="c1"># already initialized =&gt; we are inside a QGIS app.</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">masterPasswordIsSet</span><span class="p">():</span>
<span class="linenos">10</span>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Authentication master password not recognized&#39;</span>
<span class="linenos">11</span>        <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">masterPasswordSame</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">12</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Master password could not be set&#39;</span>
<span class="linenos">14</span>        <span class="c1"># The verify parameter checks if the hash of the password was</span>
<span class="linenos">15</span>        <span class="c1"># already saved in the authentication db</span>
<span class="linenos">16</span>        <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">setMasterPassword</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">,</span>
<span class="linenos">17</span>                                          <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">18</span><span class="k">else</span><span class="p">:</span>
<span class="linenos">19</span>    <span class="c1"># outside qgis, e.g. in a testing environment =&gt; setup env var before</span>
<span class="linenos">20</span>    <span class="c1"># db init</span>
<span class="linenos">21</span>    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;QGIS_AUTH_DB_DIR_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/path/where/located/qgis-auth.db&quot;</span>
<span class="linenos">22</span>    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Master password could not be set&#39;</span>
<span class="linenos">23</span>    <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">setMasterPassword</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">24</span>    <span class="n">authMgr</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;/path/where/located/qgis-auth.db&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="populate-authdb-with-a-new-authentication-configuration-entry">
<span id="populate-authdb-with-a-new-auth-entry"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">14.3.2. </span>認証データベースに新しい認証構成項目を設定する</a><a class="headerlink" href="#populate-authdb-with-a-new-authentication-configuration-entry" title="Link to this heading"></a></h3>
<p>保存された資格情報は <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethodConfig.html#qgis.core.QgsAuthMethodConfig" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethodConfig</span></code></a> クラスの <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> インスタンスで、次のような一意の文字列を使ってアクセスします:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authcfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
</pre></div>
</div>
<p>この文字列は、QGIS APIやGUIを使用してエントリーを作成する際に自動的に生成されますが、（異なる資格情報で）組織内の複数のユーザー間で設定を共有する必要がある場合、手動で既知の値に設定することが有用な場合があります。</p>
<p><a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethodConfig.html#qgis.core.QgsAuthMethodConfig" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethodConfig</span></code></a> は任意の <a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a> のベースクラスです。任意の認証方法は、認証情報が格納されるコンフィギュレーションハッシュマップを設定します。以下は、仮想的なaliceユーザのPKI-path認証情報を格納するための便利なスニペットです:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos"> 2</span><span class="c1"># set alice PKI data</span>
<span class="linenos"> 3</span><span class="n">config</span> <span class="o">=</span> <span class="n">QgsAuthMethodConfig</span><span class="p">()</span>
<span class="linenos"> 4</span><span class="n">config</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="n">config</span><span class="o">.</span><span class="n">setMethod</span><span class="p">(</span><span class="s2">&quot;PKI-Paths&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">config</span><span class="o">.</span><span class="n">setUri</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">config</span><span class="o">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s2">&quot;certpath&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/alice-cert.pem&quot;</span> <span class="p">)</span>
<span class="linenos"> 8</span><span class="n">config</span><span class="o">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s2">&quot;keypath&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/alice-key.pem&quot;</span> <span class="p">)</span>
<span class="linenos"> 9</span><span class="c1"># check if method parameters are correctly set</span>
<span class="linenos">10</span><span class="k">assert</span> <span class="n">config</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># register alice data in authdb returning the ``authcfg`` of the stored</span>
<span class="linenos">13</span><span class="c1"># configuration</span>
<span class="linenos">14</span><span class="n">authMgr</span><span class="o">.</span><span class="n">storeAuthenticationConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">newAuthCfgId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
<span class="linenos">16</span><span class="k">assert</span> <span class="n">newAuthCfgId</span>
</pre></div>
</div>
<section id="available-authentication-methods">
<span id="available-auth-methods"></span><h4><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">14.3.2.1. </span>利用可能な認証方法</a><a class="headerlink" href="#available-authentication-methods" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a> ライブラリは、認証マネージャの初期化時に動的にロードされます。利用可能な認証方式は以下の通りです:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Basic</span></code> ユーザーとパスワード認証</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EsriToken</span></code> ESRIトークン型認証</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Identity-Cert</span></code> アイデンティティ証明書認証</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OAuth2</span></code> OAuth2認証</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PKI-Paths</span></code> PKIパス認証</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PKI-PKCS＃12</span></code> PKI PKCS＃12認証</p></li>
</ol>
</section>
<section id="populate-authorities">
<span id="id4"></span><h4><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">14.3.2.2. </span>認証局の導入</a><a class="headerlink" href="#populate-authorities" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos">2</span><span class="c1"># add authorities</span>
<span class="linenos">3</span><span class="n">cacerts</span> <span class="o">=</span> <span class="n">QSslCertificate</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s2">&quot;/path/to/ca_chains.pem&quot;</span> <span class="p">)</span>
<span class="linenos">4</span><span class="k">assert</span> <span class="n">cacerts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="linenos">5</span><span class="c1"># store CA</span>
<span class="linenos">6</span><span class="n">authMgr</span><span class="o">.</span><span class="n">storeCertAuthorities</span><span class="p">(</span><span class="n">cacerts</span><span class="p">)</span>
<span class="linenos">7</span><span class="c1"># and rebuild CA caches</span>
<span class="linenos">8</span><span class="n">authMgr</span><span class="o">.</span><span class="n">rebuildCaCertsCache</span><span class="p">()</span>
<span class="linenos">9</span><span class="n">authMgr</span><span class="o">.</span><span class="n">rebuildTrustedCaCertsCache</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="manage-pki-bundles-with-qgspkibundle">
<span id="id5"></span><h4><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">14.3.2.3. </span>QgsPkiBundleでPKIバンドルを管理する</a><a class="headerlink" href="#manage-pki-bundles-with-qgspkibundle" title="Link to this heading"></a></h4>
<p>SslCert、SslKey、CAチェーンで構成されるPKIバンドルをパックする便利なクラスは <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsPkiBundle.html#qgis.core.QgsPkiBundle" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsPkiBundle</span></code></a> クラスです。以下は、パスワードで保護されるようにするためのスニペットです:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># add alice cert in case of key with pwd</span>
<span class="linenos">2</span><span class="n">caBundlesList</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of CA bundles</span>
<span class="linenos">3</span><span class="n">bundle</span> <span class="o">=</span> <span class="n">QgsPkiBundle</span><span class="o">.</span><span class="n">fromPemPaths</span><span class="p">(</span> <span class="s2">&quot;/path/to/alice-cert.pem&quot;</span><span class="p">,</span>
<span class="linenos">4</span>                                     <span class="s2">&quot;/path/to/alice-key_w-pass.pem&quot;</span><span class="p">,</span>
<span class="linenos">5</span>                                     <span class="s2">&quot;unlock_pwd&quot;</span><span class="p">,</span>
<span class="linenos">6</span>                                     <span class="n">caBundlesList</span> <span class="p">)</span>
<span class="linenos">7</span><span class="k">assert</span> <span class="n">bundle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="linenos">8</span><span class="c1"># You can check bundle validity by calling:</span>
<span class="linenos">9</span><span class="c1"># bundle.isValid()</span>
</pre></div>
</div>
<p>バンドルから証明書/鍵/CAsを取り出すには、 <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsPkiBundle.html#qgis.core.QgsPkiBundle" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsPkiBundle</span></code></a> クラスドキュメントを参照してください。</p>
</section>
</section>
<section id="remove-an-entry-from-authdb">
<span id="remove-entry-from-authdb"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">14.3.3. </span>authdbからエントリを削除する</a><a class="headerlink" href="#remove-an-entry-from-authdb" title="Link to this heading"></a></h3>
<p>次のスニペットは、<code class="docutils literal notranslate"><span class="pre">authcfg</span></code> 識別子を使って <a class="reference internal" href="#term-Authentication-Database"><span class="xref std std-term">認証データベース</span></a> からエントリを 削除します：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="n">authMgr</span><span class="o">.</span><span class="n">removeAuthenticationConfig</span><span class="p">(</span> <span class="s2">&quot;authCfg_Id_to_remove&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="leave-authcfg-expansion-to-qgsauthmanager">
<span id="id6"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">14.3.4. </span>QgsAuthManagerにauthcfg展開を残す</a><a class="headerlink" href="#leave-authcfg-expansion-to-qgsauthmanager" title="Link to this heading"></a></h3>
<p>The best way to use an <a class="reference internal" href="#term-Authentication-Config"><span class="xref std std-term">Authentication Config</span></a> stored in the
<a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a> is referring it with the unique identifier
<code class="docutils literal notranslate"><span class="pre">authcfg</span></code>. Expanding, means convert it from an identifier to a complete
set of credentials.
The best practice to use stored <a class="reference internal" href="#term-Authentication-Config"><span class="xref std std-term">Authentication Config</span></a>s, is to leave it
managed automatically by the Authentication manager.
The common use of a stored configuration is to connect to an authentication
enabled service like a WMS or WFS or to a DB connection.</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>すべてのQGISデータプロバイダーが認証インフラストラクチャに統合されているわけではないことを考慮してください。各認証メソッドは基本クラス <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethod.html#qgis.core.QgsAuthMethod" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethod</span></code></a> から派生し、異なるプロバイダのセットをサポートします。例えば、 <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager.certIdentity" title="(in QGIS Python API v3.34)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">certIdentity()</span></code></a> メソッドは以下のプロバイダのリストをサポートしています:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authM</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">authM</span><span class="o">.</span><span class="n">authMethod</span><span class="p">(</span><span class="s2">&quot;Identity-Cert&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">supportedDataProviders</span><span class="p">())</span>
</pre></div>
</div>
<p>サンプル出力:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;ows&#39;, &#39;wfs&#39;, &#39;wcs&#39;, &#39;wms&#39;, &#39;postgres&#39;]
</pre></div>
</div>
</div>
<p>例えば、 <code class="docutils literal notranslate"><span class="pre">authcfg</span> <span class="pre">=</span> <span class="pre">'fm1s770'</span></code> で識別される、保存された資格情報を使ってWMSサービスにアクセスするためには、次のコードのように、データ・ソースのURLに <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> を使う必要があります。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authCfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
<span class="linenos"> 2</span><span class="n">quri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">()</span>
<span class="linenos"> 3</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;layers&quot;</span><span class="p">,</span> <span class="s1">&#39;usa:states&#39;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;styles&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s1">&#39;image/png&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;crs&quot;</span><span class="p">,</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;dpiMode&quot;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;featureCount&quot;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;authcfg&quot;</span><span class="p">,</span> <span class="n">authCfg</span><span class="p">)</span>   <span class="c1"># &lt;---- here my authCfg url parameter</span>
<span class="linenos">10</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;contextualWMSLegend&quot;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s1">&#39;https://my_auth_enabled_server_ip/wms&#39;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">quri</span><span class="o">.</span><span class="n">encodedUri</span><span class="p">(),</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;wms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>上の場合には、 <code class="docutils literal notranslate"><span class="pre">wms</span></code> プロバイダーは、単にHTTP接続を設定する前に、資格を <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> URIパラメーターを拡張するために世話をします。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>開発者は <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> の拡張を <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthManager</span></code></a> に任せる必要があるでしょう。このようにすれば、拡張が早すぎることはないでしょう。</p>
</div>
<p>通常、データソースの設定には <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsDataSourceUri.html#qgis.core.QgsDataSourceUri" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsDataSourceURI</span></code></a> クラスを用いて構築された URI 文字列を以下のように使用することができます:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authCfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
<span class="n">quri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">(</span><span class="s2">&quot;my WMS uri here&quot;</span><span class="p">)</span>
<span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;authcfg&quot;</span><span class="p">,</span> <span class="n">authCfg</span><span class="p">)</span>
<span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span> <span class="n">quri</span><span class="o">.</span><span class="n">uri</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;wms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><code class="docutils literal notranslate"><span class="pre">False</span></code> パラメーターは、URIで <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> IDの存在のURI完全な展開を避けるために重要です。</p>
</div>
<section id="pki-examples-with-other-data-providers">
<span id="id7"></span><h4><a class="toc-backref" href="#id22" role="doc-backlink"><span class="section-number">14.3.4.1. </span>他のデータプロバイダーとPKIの例</a><a class="headerlink" href="#pki-examples-with-other-data-providers" title="Link to this heading"></a></h4>
<p>その他の例は、 <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_authmanager_pki_ows.py">test_authmanager_pki_ows</a> や <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_authmanager_pki_postgres.py">test_authmanager_pki_postgres</a> というようにQGISテストアップストリームで直接読むことができます。</p>
</section>
</section>
</section>
<section id="adapt-plugins-to-use-authentication-infrastructure">
<span id="adapt-plugins-to-use-auth-infrastructure"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">14.4. </span>認証インフラストラクチャを使用するようにプラグインを適応させる</a><a class="headerlink" href="#adapt-plugins-to-use-authentication-infrastructure" title="Link to this heading"></a></h2>
<p>多くのサードパーティプラグインは、HTTP接続を管理するために、 <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsNetworkAccessManager.html#qgis.core.QgsNetworkAccessManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsNetworkAccessManager</span></code></a> とそれに関連する認証基盤の統合の代わりに、httplib2や他のPythonネットワークライブラリを使用しています。</p>
<p>この統合を容易にするために、<code class="docutils literal notranslate"><span class="pre">NetworkAccessManager</span></code> というPythonのヘルパー関数が作られました。このコードは、<a class="reference external" href="https://github.com/rduivenvoorde/pdokservicesplugin/blob/master/networkaccessmanager.py">ここ</a> にあります。</p>
<p>このヘルパークラスは、次のスニペットのように使うことができます:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">http</span> <span class="o">=</span> <span class="n">NetworkAccessManager</span><span class="p">(</span><span class="n">authid</span><span class="o">=</span><span class="s2">&quot;my_authCfg&quot;</span><span class="p">,</span> <span class="n">exception_class</span><span class="o">=</span><span class="n">My_FailedRequestError</span><span class="p">)</span>
<span class="linenos">2</span><span class="k">try</span><span class="p">:</span>
<span class="linenos">3</span>  <span class="n">response</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span> <span class="s2">&quot;my_rest_url&quot;</span> <span class="p">)</span>
<span class="linenos">4</span><span class="k">except</span> <span class="n">My_FailedRequestError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">5</span>  <span class="c1"># Handle exception</span>
<span class="linenos">6</span>  <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="authentication-guis">
<span id="id8"></span><h2><a class="toc-backref" href="#id24" role="doc-backlink"><span class="section-number">14.5. </span>認証のGUI</a><a class="headerlink" href="#authentication-guis" title="Link to this heading"></a></h2>
<p>この段落では、カスタムインターフェイスで認証インフラストラクチャを統合するために役立つ利用可能なGUIが記載されています。</p>
<section id="gui-to-select-credentials">
<span id="id9"></span><h3><a class="toc-backref" href="#id25" role="doc-backlink"><span class="section-number">14.5.1. </span>資格情報を選択するためのGUI</a><a class="headerlink" href="#gui-to-select-credentials" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a> に格納されているセットから <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> を選択する必要がある場合は、GUIクラス <a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigSelect.html#qgis.gui.QgsAuthConfigSelect" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigSelect</span></code></a> で利用可能です。</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthConfigSelect.png" src="../../_images/QgsAuthConfigSelect.png" />
</figure>
<p>そして次のコードのように使用できます：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthConfigSelect GUI hierarchically linked to</span>
<span class="linenos">2</span><span class="c1"># the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthConfigSelect</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span> <span class="p">)</span>
<span class="linenos">5</span><span class="c1"># add the above created gui in a new tab of the interface where the</span>
<span class="linenos">6</span><span class="c1"># GUI has to be integrated</span>
<span class="linenos">7</span><span class="n">tabGui</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
<span class="linenos">8</span><span class="n">tabGui</span><span class="o">.</span><span class="n">insertTab</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gui</span><span class="p">,</span> <span class="s2">&quot;Configurations&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>上記の例は、QGISのソース <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/src/providers/postgres/qgspgnewconnection.cpp#L42">code</a> から引用しています。GUIコンストラクタの第2パラメータは、データプロバイダタイプを指します。このパラメータは、指定したプロバイダと互換性のある <a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a> を制限するために使用されます。</p>
</section>
<section id="authentication-editor-gui">
<span id="id10"></span><h3><a class="toc-backref" href="#id26" role="doc-backlink"><span class="section-number">14.5.2. </span>認証エディタのGUI</a><a class="headerlink" href="#authentication-editor-gui" title="Link to this heading"></a></h3>
<p>資格情報、認証局を管理し、認証ユーティリティにアクセスするための完全なGUIは <a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthEditorWidgets.html#qgis.gui.QgsAuthEditorWidgets" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthEditorWidgets</span></code></a> クラスによって管理されています。</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthEditorWidgets.png" src="../../_images/QgsAuthEditorWidgets.png" />
</figure>
<p>そして次のコードのように使用できます：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthEditorWidgets GUI hierarchically linked to</span>
<span class="linenos">2</span><span class="c1"># the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthConfigSelect</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
<span class="linenos">5</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>統合された例は、関連する <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_qgsauthsystem.py#L80">test</a> で見つけることができます。</p>
</section>
<section id="authorities-editor-gui">
<span id="id11"></span><h3><a class="toc-backref" href="#id27" role="doc-backlink"><span class="section-number">14.5.3. </span>認証局エディタのGUI</a><a class="headerlink" href="#authorities-editor-gui" title="Link to this heading"></a></h3>
<p>認証局だけを管理するためのGUIは <a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthAuthoritiesEditor.html#qgis.gui.QgsAuthAuthoritiesEditor" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthAuthoritiesEditor</span></code></a> クラスで管理します。</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthAuthoritiesEditor.png" src="../../_images/QgsAuthAuthoritiesEditor.png" />
</figure>
<p>そして次のコードのように使用できます：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthAuthoritiesEditor GUI hierarchically</span>
<span class="linenos">2</span><span class="c1">#  linked to the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthAuthoritiesEditor</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
<span class="linenos">5</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="communicating.html" class="btn btn-neutral float-left" title="13. ユーザーとコミュニケーションする" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tasks.html" class="btn btn-neutral float-right" title="15. タスク - バックグラウンドで重い仕事をする" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">最終更新: 2024 6月 25, 05:29 +0900
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages:
Expected French translation link for https://docs.qgis.org/3.28/en/docs/user_manual/print_composer/overview_composer.html
would return https://app.transifex.com/qgis/qgis-documentation/translate/#fr/aa6d8bc653526d38b295ca94bf8eee5e
with the md5 value of "github#qgis/QGIS-Documentation#release_3.28#locale/en/LC_MESSAGES/docs/user_manual/print_composer/overview_composer.po"-->
<!--Make sure that mismatching language codes between Transifex and Sphinx are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: 3.34
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/en/docs/pyqgis_developer_cookbook/authentication.html">en</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/cs/docs/pyqgis_developer_cookbook/authentication.html">cs</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/de/docs/pyqgis_developer_cookbook/authentication.html">de</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/es/docs/pyqgis_developer_cookbook/authentication.html">es</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/fr/docs/pyqgis_developer_cookbook/authentication.html">fr</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/hu/docs/pyqgis_developer_cookbook/authentication.html">hu</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/it/docs/pyqgis_developer_cookbook/authentication.html">it</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ja/docs/pyqgis_developer_cookbook/authentication.html">ja</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ko/docs/pyqgis_developer_cookbook/authentication.html">ko</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/lt/docs/pyqgis_developer_cookbook/authentication.html">lt</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/nl/docs/pyqgis_developer_cookbook/authentication.html">nl</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_BR/docs/pyqgis_developer_cookbook/authentication.html">pt_BR</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_PT/docs/pyqgis_developer_cookbook/authentication.html">pt_PT</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ro/docs/pyqgis_developer_cookbook/authentication.html">ro</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ru/docs/pyqgis_developer_cookbook/authentication.html">ru</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zh-Hans/docs/pyqgis_developer_cookbook/authentication.html">zh-Hans</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/ja/docs/pyqgis_developer_cookbook/authentication.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/ja/docs/pyqgis_developer_cookbook/authentication.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ja/docs/pyqgis_developer_cookbook/authentication.html">3.34</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.28/ja/docs/pyqgis_developer_cookbook/authentication.html">3.28</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.22/ja/docs/pyqgis_developer_cookbook/authentication.html">3.22</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/ja/docs/pyqgis_developer_cookbook/authentication.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/ja/docs/pyqgis_developer_cookbook/authentication.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/ja/docs/pyqgis_developer_cookbook/authentication.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/ja/docs/pyqgis_developer_cookbook/authentication.html">2.18</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/pyqgis_developer_cookbook/authentication.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://app.transifex.com/qgis/qgis-documentation/translate/#ja/29483b356636567227347a248f463599" target="_blank" rel="noopener noreferrer">Translate Page</a>
          </dd>
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/ja" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/3.34" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/3.34" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/release-3_34" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>