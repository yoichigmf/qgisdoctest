<!DOCTYPE html>
<html class="writer-html5" lang="ja" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15.3. データ形式とフィールドを探究する &mdash; QGIS Documentation  ドキュメント</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/qgis_docs.css?v=5415a924" />
      <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />

  
    <link rel="shortcut icon" href="../../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/user_manual/managing_data_source/supported_data.html"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=c033477b"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../../_static/translations.js?v=4dbe4bdc"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="検索" href="../../../search.html" />
    <link rel="next" title="16. ベクタデータの操作" href="../working_with_vector/index.html" />
    <link rel="prev" title="15.2. レイヤを作成する" href="create_layers.html" />
  <meta name="description" content="QGIS 3.34 documentation: 15.3. データ形式とフィールドを探究する">
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   

          
          
          <a href="../../index.html" class="icon icon-home">
            QGIS Documentation
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.34
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ユーザ向け</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">QGIS Desktopユーザーガイド／マニュアル (QGIS 3.34)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../preamble/preamble.html">1. はじめに</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/foreword.html">2. 序文</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/conventions.html">3. 記述ルール</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/features.html">4. 機能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/getting_started.html">5. 最初のステップ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/project_files.html">6. プロジェクトファイルの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_gui.html">7. QGISのユーザインタフェース</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/browser.html">8. ブラウザパネル</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/qgis_configuration.html">9. QGISの設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_projections/working_with_projections.html">10. 投影法の操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../map_views/index.html">11. 地図の可視化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/general_tools.html">12. 一般ツール</a></li>
<li class="toctree-l2"><a class="reference internal" href="../expressions/index.html">13. 式でレベルアップ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style_library/index.html">14. スタイルライブラリ</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">15. データソースの管理</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="opening_data.html">15.1. データを開く</a></li>
<li class="toctree-l3"><a class="reference internal" href="create_layers.html">15.2. レイヤを作成する</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">15.3. データ形式とフィールドを探究する</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#raster-data">15.3.1. ラスタデータ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vector-data">15.3.2. ベクタデータ</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layers-crossing-180-longitude">15.3.3. 経度 180° をまたぐレイヤ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_vector/index.html">16. ベクタデータの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_raster/index.html">17. ラスタデータの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_mesh/mesh.html">18. メッシュデータの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_vector_tiles/vector_tiles.html">19. ベクタタイルの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_point_clouds/point_clouds.html">20. 点群の操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_3d_tiles/3d_tiles.html">21. 3Dタイルの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../print_composer/index.html">22. 地図のレイアウト</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_ogc/ogc_client_support.html">23. OGC / ISOプロトコルの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_gps/index.html">24. GPSデータの操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auth_system/index.html">25. 認証システム</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grass_integration/grass_integration.html">26. GRASS GIS の統合</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing/index.html">27. QGIS プロセシングフレームワーク</a></li>
<li class="toctree-l2"><a class="reference internal" href="../processing_algs/index.html">28. プロセシングプロバイダとアルゴリズム</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/index.html">29. プラグイン</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/help_and_support.html">30. ヘルプとサポート</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preamble/contributors.html">31. 協力者</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/index.html">32. 付録</a></li>
<li class="toctree-l2"><a class="reference internal" href="../literature_web/literature_and_web_references.html">33. 文献とWeb参照</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../server_manual/index.html">QGIS Serverガイド／マニュアル (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training_manual/index.html">トレーニングマニュアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gentle_gis_introduction/index.html">やさしい GIS 入門</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ドキュメント執筆者向け</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../documentation_guidelines/index.html">ドキュメント作成のガイドライン</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">開発者向け</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pyqgis_developer_cookbook/index.html">PyQGISクックブック (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developers_guide/index.html">開発者ガイド</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">QGISユーザガイド</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">15. </span>データソースの管理</a></li>
      <li class="breadcrumb-item active"><span class="section-number">15.3. </span>データ形式とフィールドを探究する</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/user_manual/managing_data_source/supported_data.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="create_layers.html" class="btn btn-neutral float-left" title="15.2. レイヤを作成する" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../working_with_vector/index.html" class="btn btn-neutral float-right" title="16. ベクタデータの操作" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <blockquote>
<div><div class="admonition important">
<p class="admonition-title">重要</p>
<p>翻訳は <a class="reference external" href="https://qgis.org/en/site/getinvolved/translate.html#becoming-a-translator">あなたが参加できる</a> コミュニティの取り組みです。このページは現在 100.00% 翻訳されています。</p>
</div>
</div></blockquote>
<section id="exploring-data-formats-and-fields">
<span id="supported-format"></span><h1><span class="section-number">15.3. </span>データ形式とフィールドを探究する<a class="headerlink" href="#exploring-data-formats-and-fields" title="Link to this heading"></a></h1>
<nav class="contents local" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#raster-data" id="id5">ラスタデータ</a></p></li>
<li><p><a class="reference internal" href="#vector-data" id="id6">ベクタデータ</a></p>
<ul>
<li><p><a class="reference internal" href="#geopackage" id="id7">GeoPackage</a></p></li>
<li><p><a class="reference internal" href="#esri-shapefile-format" id="id8">ESRIシェープファイル形式</a></p></li>
<li><p><a class="reference internal" href="#delimited-text-files" id="id9">区切りテキストファイル</a></p>
<ul>
<li><p><a class="reference internal" href="#storing-geometry-information-in-delimited-text-files" id="id10">区切りテキストファイルへのジオメトリ情報の保存</a></p></li>
<li><p><a class="reference internal" href="#using-csvt-file-to-control-field-formatting" id="id11">CSVTファイルを使用したフィールドの書式制御</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#postgis-layers" id="id12">PostGISレイヤ</a></p>
<ul>
<li><p><a class="reference internal" href="#primary-key" id="id13">主キー</a></p></li>
<li><p><a class="reference internal" href="#view" id="id14">ビュー</a></p></li>
<li><p><a class="reference internal" href="#qgis-layer-style-table-and-database-backup" id="id15">QGIS layer_style テーブルとデータベースのバックアップ</a></p></li>
<li><p><a class="reference internal" href="#filter-database-side" id="id16">データベース側でのフィルタ</a></p></li>
<li><p><a class="reference internal" href="#support-of-postgresql-data-types" id="id17">PostgreSQLのデータ型のサポート</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#importing-data-into-postgresql" id="id18">PostgreSQLへデータをインポートする</a></p>
<ul>
<li><p><a class="reference internal" href="#db-manager" id="id19">DBマネージャ</a></p></li>
<li><p><a class="reference internal" href="#shp2pgsql" id="id20">shp2pgsql</a></p></li>
<li><p><a class="reference internal" href="#ogr2ogr" id="id21">ogr2ogr</a></p></li>
<li><p><a class="reference internal" href="#improving-performance" id="id22">パフォーマンスの改善</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#spatialite-layers" id="id23">SpatiaLiteレイヤ</a></p></li>
<li><p><a class="reference internal" href="#geojson-specific-parameters" id="id24">GeoJSONに特有のパラメータ</a></p></li>
<li><p><a class="reference internal" href="#sap-hana-spatial-layers" id="id25">SAP HANA空間レイヤ</a></p>
<ul>
<li><p><a class="reference internal" href="#feature-identification" id="id26">地物の識別</a></p></li>
<li><p><a class="reference internal" href="#adding-tables" id="id27">テーブルの追加</a></p></li>
<li><p><a class="reference internal" href="#adding-views" id="id28">ビューの追加</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#layers-crossing-180-longitude" id="id29">経度 180° をまたぐレイヤ</a></p>
<ul>
<li><p><a class="reference internal" href="#solving-in-postgis" id="id30">PostGISで解決する</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="raster-data">
<h2><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">15.3.1. </span>ラスタデータ</a><a class="headerlink" href="#raster-data" title="Link to this heading"></a></h2>
<p>GISラスタデータは、地表面上、大気中、地下の特徴や現象を表す離散的なセルの行列です。ラスタグリッドの各セルは同じサイズで、セルは通常、長方形（QGIS では常に長方形）です。典型的なラスタデータセットには、航空写真や衛星画像などのリモートセンシングデータ、標高や気温などのモデル化されたデータなどがあります。</p>
<p>ベクタデータとは異なり、ラスタデータは通常、各セルに関連するデータベースレコードを持ちません。これらのデータは、ピクセル解像度とラスタレイヤのコーナーピクセルの X/Y 座標によってジオコーディングされています。これにより、QGISはマップキャンバス上にデータを正確に配置することができます。</p>
<p>GeoPackage形式は、QGISで作業する際にラスタデータを保持するのに便利な形式です。一般的で強力な機能を持つGeoTiff形式も良い選択肢になります。</p>
<p>QGISは適切にデータを表示するために、ラスタレイヤ内部（例： <span class="target" id="index-15"></span>GeoTiff ）や関連付けられた <em>ワールドファイル</em> のジオリファレンス情報を利用しています。</p>
</section>
<section id="vector-data">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">15.3.2. </span>ベクタデータ</a><a class="headerlink" href="#vector-data" title="Link to this heading"></a></h2>
<p>QGISで利用できる機能やツールの多くは、ベクタデータのソースに関係なく同じように動作します。ただし、フォーマット（GeoPackage、ESRIシェープファイル、MapInfoやMicroStationファイル形式、AutoCAD DXF、PostGIS、SpatiaLite、DB2、Oracle Spatial、MS SQL Server、SAP HANA空間データベース、その他多数）の仕様が異なるため、QGISでは一部のプロパティの扱いが異なる場合があります。フォーマットのサポートは <a class="reference external" href="https://gdal.org/drivers/vector/index.html">GDAL vector drivers</a> によって提供されています。このセクションでは、この差異をどのように扱うかについて説明します。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>QGISではポイント（マルチポイント）、ライン（マルチライン）、ポリゴン（マルチポリゴン）、円形ストリング、複合カーブ、カーブポリゴン、マルチカーブ、マルチサーフェスの地物タイプをサポートしており、全ての地物タイプはオプションでZ値やM値を持つことができます。</p>
<p>一部のドライバは円形ストリング、複合カーブ、カーブポリゴン、マルチカーブ、マルチサーフェスの地物タイプなどをサポートしていないことに注意してください。QGISはこれらを変換します。</p>
</div>
<section id="geopackage">
<span id="vector-geopackage"></span><span id="index-1"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">15.3.2.1. </span>GeoPackage</a><a class="headerlink" href="#geopackage" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://www.geopackage.org/">GeoPackage</a> （GPKG）形式はプラットフォームに依存しない形式で、SQLiteデータベースコンテナとして実装されており、ベクタデータとラスタデータの両方を格納するために使用することができます。この形式はOpen Geospatial Consortium （OGC）によって定義され、2014年に公開されました。</p>
<p>GeoPackageはSQLiteデータベース内に以下のものを格納するために使用できます：</p>
<ul class="simple">
<li><p><strong>ベクタ</strong> 地物</p></li>
<li><p><strong>画像のタイルマトリックスセット</strong> や <strong>ラスタ</strong> マップ</p></li>
<li><p>属性データ（非空間データ）</p></li>
<li><p>拡張情報</p></li>
</ul>
<p>QGISバージョン3.8以降では、GeoPackageはQGISのプロジェクトを保存できるようになりました。GeoPackageレイヤはJSONフィールドを持つことができます。</p>
<p>GeoPackageはQGISにおいてベクタデータのデフォルトの形式です。</p>
</section>
<section id="esri-shapefile-format">
<span id="vector-shapefiles"></span><span id="index-2"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">15.3.2.2. </span>ESRIシェープファイル形式</a><a class="headerlink" href="#esri-shapefile-format" title="Link to this heading"></a></h3>
<p>例えばGeoPackageやSpatiaLiteと比較するといくつかの制限はありますが、ESRIシェープファイル形式は未だに最も使われているベクタファイル形式の一つです。</p>
<p>ESRIシェープファイル形式のデータセットはいくつかのファイルからなります。下記の3つは必須です。</p>
<ol class="arabic simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">.shp</span></code> ファイルは地物のジオメトリを持ちます。</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">.dbf</span></code> ファイルはdBase形式で属性を保持します。</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">.shx</span></code> インデックスファイル</p></li>
</ol>
<p>ESRIシェープファイル形式のデータセットは、投影法に関する情報を持った <code class="file docutils literal notranslate"><span class="pre">.prj</span></code> 拡張子を持つファイルを含めることもできます。投影法ファイルがあると便利ですが、これは必須ではありません。シェープファイル形式のデータセットには追加のファイルを含めることもできます。詳細については、ESRIの <a class="reference external" href="https://www.esri.com/content/dam/esrisites/sitecore-archive/Files/Pdfs/library/whitepapers/pdfs/shapefile.pdf">技術仕様</a> を参照してください。</p>
<p>GDALでは圧縮されたESRIシェープファイル形式（ <code class="file docutils literal notranslate"><span class="pre">shz</span></code> や <code class="file docutils literal notranslate"><span class="pre">shp.zip</span></code> ）の読み書きをサポートしています。</p>
<p><strong>ESRIシェープファイル形式のデータセットのパフォーマンスを向上させる</strong></p>
<p>ESRIシェープファイル形式のデータセットの描画パフォーマンスを向上するには、空間インデックスを作成します。空間インデックスによってズーム、パン両方の速度が向上します。QGISで使用される空間インデックスは <code class="file docutils literal notranslate"><span class="pre">.qix</span></code> 拡張子を持ちます。</p>
<p>空間インデックスを作成するには、以下の手順で操作します：</p>
<ol class="arabic simple">
<li><p>ESRIシェープファイル形式のデータセットを読み込む（ <a class="reference internal" href="opening_data.html#browser-panel"><span class="std std-ref">ブラウザパネル</span></a> 参照）</p></li>
<li><p>凡例内のレイヤ名をダブルクリックするか、右クリックしてコンテキストメニューから <span class="menuselection">プロパティ...</span> を選択し、 <span class="guilabel">レイヤプロパティ</span> ダイアログを開く</p></li>
<li><p><span class="guilabel">ソース</span> タブで、 <span class="guilabel">空間インデックスの作成</span> ボタンを押す</p></li>
</ol>
<p><strong>.prj ファイルの読み込みに関する問題</strong></p>
<p><code class="file docutils literal notranslate"><span class="pre">.prj</span></code> ファイルを持ったESRIシェープファイル形式のデータセットを読み込んでもQGISがそのファイルから座標参照系を読み取れない場合は、レイヤの <span class="menuselection">レイヤプロパティ ► ソース</span> タブで <a class="reference internal" href="../../../_images/mActionSetProjection.png"><img alt="setProjection" src="../../../_images/mActionSetProjection.png" style="width: 1.5em;" /></a> <sup>CRSの選択</sup> ボタンをクリックし、適切な投影法を手動で定義する必要があります。これは、 <code class="file docutils literal notranslate"><span class="pre">.prj</span></code> ファイルが <span class="guilabel">CRS</span> ダイアログで表示されるようなQGISで使用される投影法パラメータを完全には指定していないことが多いためです。</p>
<p>同じ理由で、QGISで新しいESRIシェープファイル形式のデータセットを作成すると、2 つの異なる投影ファイルが作成されます：ESRIソフトウェアと互換性のある、限定された投影パラメータの <code class="file docutils literal notranslate"><span class="pre">.prj</span></code> ファイルと、CRSのすべてのパラメータを指定する <code class="file docutils literal notranslate"><span class="pre">.qpj</span></code> ファイルです。QGISが <code class="file docutils literal notranslate"><span class="pre">.qpj</span></code> ファイルを見つけた時には、これが <code class="file docutils literal notranslate"><span class="pre">.prj</span></code> ファイルの代わりに使用されます。</p>
</section>
<section id="delimited-text-files">
<span id="vector-csv"></span><span id="index-3"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">15.3.2.3. </span>区切りテキストファイル</a><a class="headerlink" href="#delimited-text-files" title="Link to this heading"></a></h3>
<p>区切りテキストファイルは、そのシンプルさと読みやすさから非常に一般的であり広く使われています。データはプレーンテキストエディタで閲覧・編集が可能です。区切りテキストファイルは表形式のデータで、列は決められた文字で区切られ、行は改行で区切られます。通常、最初の行には列名が含まれています。区切りテキストファイルの一般的なタイプは、列がカンマで区切られた CSV（Comma Separated Values）です。区切りテキストファイルは位置情報を含むこともできます（ <a class="reference internal" href="#csv-geometry"><span class="std std-ref">区切りテキストファイルへのジオメトリ情報の保存</span></a> を参照してください）。</p>
<p>QGISでは、区切りテキストファイルをレイヤや通常のテーブルとして読み込むことができます（ <a class="reference internal" href="opening_data.html#browser-panel"><span class="std std-ref">ブラウザパネル</span></a> や <a class="reference internal" href="opening_data.html#vector-loading-csv"><span class="std std-ref">区切りテキストファイルをインポートする</span></a> を参照）。まずは、ファイルが以下の条件を満たしていることを確認しましょう。</p>
<ol class="arabic simple">
<li><p>ファイルにはフィールド名を区切ったヘッダ行が必要です。これはデータの最初の行（理想的にはテキストファイルの最初の行）でなければなりません。</p></li>
<li><p>ジオメトリを有効にする場合には、ファイルにはジオメトリを定義するフィールドが含まれている必要があります。これらのフィールドには任意の名前を付けることができます。</p></li>
<li><p>（ジオメトリが座標で定義されている場合は）XとYの座標フィールドは数値で指定する必要があります。座標系は重要ではありません。</p></li>
<li><p>文字列以外の列を持つCSVファイルがある場合、付随するCSVTファイルを持つことができます（ <a class="reference internal" href="#csvt-files"><span class="std std-ref">CSVTファイルを使用したフィールドの書式制御</span></a> のセクションを参照してください）。</p></li>
</ol>
<p>QGISサンプルデータセット（ <a class="reference internal" href="../introduction/getting_started.html#label-sampledata"><span class="std std-ref">サンプルデータのダウンロード</span></a> のセクション参照）内の標高点データファイル <code class="file docutils literal notranslate"><span class="pre">elevp.csv</span></code> は、有効なテキストファイルの例です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">;</span><span class="n">Y</span><span class="p">;</span><span class="n">ELEV</span>
<span class="o">-</span><span class="mi">300120</span><span class="p">;</span><span class="mi">7689960</span><span class="p">;</span><span class="mi">13</span>
<span class="o">-</span><span class="mi">654360</span><span class="p">;</span><span class="mi">7562040</span><span class="p">;</span><span class="mi">52</span>
<span class="mi">1640</span><span class="p">;</span><span class="mi">7512840</span><span class="p">;</span><span class="mi">3</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>このテキストファイルの注意点をいくつか挙げます：</p>
<ol class="arabic simple">
<li><p>このテキストファイル例では、 <code class="docutils literal notranslate"><span class="pre">;</span></code> （セミコロン）を区切り文字として使用しています（フィールドの区切りには任意の文字を使用可能です）。</p></li>
<li><p>最初の行は見出しです。ここには <code class="docutils literal notranslate"><span class="pre">X</span></code> 、 <code class="docutils literal notranslate"><span class="pre">Y</span></code> および <code class="docutils literal notranslate"><span class="pre">ELEV</span></code> というフィールドが含まれています。</p></li>
<li><p>テキストフィールドを区切るための引用符（ <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> ）は使われていません。</p></li>
<li><p>X座標は <code class="docutils literal notranslate"><span class="pre">X</span></code> フィールドに含まれています</p></li>
<li><p>Y座標は <code class="docutils literal notranslate"><span class="pre">Y</span></code> フィールドに含まれています</p></li>
</ol>
<section id="storing-geometry-information-in-delimited-text-files">
<span id="csv-geometry"></span><h4><a class="toc-backref" href="#id10" role="doc-backlink">区切りテキストファイルへのジオメトリ情報の保存</a><a class="headerlink" href="#storing-geometry-information-in-delimited-text-files" title="Link to this heading"></a></h4>
<p>区切りテキストファイルには、主に2つの形式でジオメトリ情報を含めることができます：</p>
<ul class="simple">
<li><p>ポイントジオメトリデータの場合は、別々の列に座標（例えば <code class="docutils literal notranslate"><span class="pre">Xcol</span></code> 、 <code class="docutils literal notranslate"><span class="pre">Ycol</span></code>... ）として含める</p></li>
<li><p>任意のジオメトリタイプの場合は、単一の列にジオメトリの well-known text (WKT) 表現として含める</p></li>
</ul>
<p>曲線ジオメトリ(CircularString, CurvePolygon, CompoundCurve) を持つ地物がサポートされています。以下は、WKTとして符号化されたジオメトリを持った区切りテキストファイルに含まれるジオメトリタイプの例です:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Label</span><span class="p">;</span><span class="n">WKT_geom</span>
<span class="n">LineString</span><span class="p">;</span><span class="n">LINESTRING</span><span class="p">(</span><span class="mf">10.0</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">11.0</span> <span class="mf">21.0</span><span class="p">,</span> <span class="mf">13.0</span> <span class="mf">25.5</span><span class="p">)</span>
<span class="n">CircularString</span><span class="p">;</span><span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">268</span> <span class="mi">415</span><span class="p">,</span><span class="mi">227</span> <span class="mi">505</span><span class="p">,</span><span class="mi">227</span> <span class="mi">406</span><span class="p">)</span>
<span class="n">CurvePolygon</span><span class="p">;</span><span class="n">CURVEPOLYGON</span><span class="p">(</span><span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">1</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">CompoundCurve</span><span class="p">;</span><span class="n">COMPOUNDCURVE</span><span class="p">((</span><span class="mi">5</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">13</span><span class="p">),</span> <span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">5</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">7</span> <span class="mi">15</span><span class="p">,</span>
  <span class="mi">9</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">9</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">9</span> <span class="mi">3</span><span class="p">),</span> <span class="n">CIRCULARSTRING</span><span class="p">(</span><span class="mi">9</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>区切りテキストファイルはジオメトリの Z 座標や M 座標もサポートしています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LINESTRINGZ</span><span class="p">(</span><span class="mf">10.0</span> <span class="mf">20.0</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">11.0</span> <span class="mf">21.0</span> <span class="mf">31.0</span><span class="p">,</span> <span class="mf">11.0</span> <span class="mf">22.0</span> <span class="mf">30.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-csvt-file-to-control-field-formatting">
<span id="csvt-files"></span><span id="index-4"></span><h4><a class="toc-backref" href="#id11" role="doc-backlink">CSVTファイルを使用したフィールドの書式制御</a><a class="headerlink" href="#using-csvt-file-to-control-field-formatting" title="Link to this heading"></a></h4>
<p>CSVファイルを読み込む際GDALドライバは、別の指定がない限り、全てのフィールドを文字列（テキスト）と仮定します。CSVTファイルを作成することで、さまざまな列のデータ型をGDAL（そしてQGIS）に伝えることができます。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>タイプ</p></th>
<th class="head"><p>名前</p></th>
<th class="head"><p>例</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>整数値</p></td>
<td><p>Integer</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>ブール値</p></td>
<td><p>Integer(Boolean)</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-even"><td><p>小数点付き数値</p></td>
<td><p>Real</p></td>
<td><p>3.456</p></td>
</tr>
<tr class="row-odd"><td><p>日付</p></td>
<td><p>Date (YYYY-MM-DD)</p></td>
<td><p>2016-07-28</p></td>
</tr>
<tr class="row-even"><td><p>時刻</p></td>
<td><p>Time (HH:MM:SS+nn)</p></td>
<td><p>18:33:12+00</p></td>
</tr>
<tr class="row-odd"><td><p>日付と時刻</p></td>
<td><p>DateTime (YYYY-MM-DD HH:MM:SS+nn)</p></td>
<td><p>2016-07-28 18:33:12+00</p></td>
</tr>
<tr class="row-even"><td><p>CoordX</p></td>
<td><p>CoordX</p></td>
<td><p>8.8249</p></td>
</tr>
<tr class="row-odd"><td><p>CoordY</p></td>
<td><p>CoordY</p></td>
<td><p>47.2274</p></td>
</tr>
<tr class="row-even"><td><p>Point(X)</p></td>
<td><p>Point(X)</p></td>
<td><p>8.8249</p></td>
</tr>
<tr class="row-odd"><td><p>Point(Y)</p></td>
<td><p>Point(Y)</p></td>
<td><p>47.2274</p></td>
</tr>
<tr class="row-even"><td><p>WKT</p></td>
<td><p>WKT</p></td>
<td><p>POINT(15 20)</p></td>
</tr>
</tbody>
</table>
<p>CSVTファイルは、データ型が引用符で囲まれ、コンマで区切られた <strong>一行</strong> のプレーンテキストファイルです。例えば</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Integer&quot;</span><span class="p">,</span><span class="s2">&quot;Real&quot;</span><span class="p">,</span><span class="s2">&quot;String&quot;</span>
</pre></div>
</div>
<p>各列の幅や精度を指定することもできます。例</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;Integer(6)&quot;</span><span class="p">,</span><span class="s2">&quot;Real(5.5)&quot;</span><span class="p">,</span><span class="s2">&quot;String(22)&quot;</span>
</pre></div>
</div>
<p>このファイルは <code class="file docutils literal notranslate"><span class="pre">.csv</span></code> ファイルと同じフォルダに同じ名前で保存されますが、拡張子は <code class="file docutils literal notranslate"><span class="pre">.csvt</span></code> です。</p>
<p><em>更なる情報については</em> <a class="reference external" href="https://gdal.org/drivers/vector/csv.html">GDAL CSV Driver</a> を参照してください。</p>
<div class="admonition tip" id="tip-detect-field-types">
<p class="admonition-title">Tip</p>
<p><strong>フィールド型を検知する</strong></p>
<p>CSVTファイルを使用してデータ型を伝える代わりに、QGISはフィールド型を自動的に検出し、想定されるフィールド型を変更する可能性を提供します。</p>
</div>
</section>
</section>
<section id="postgis-layers">
<span id="label-postgis"></span><span id="index-5"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">15.3.2.4. </span>PostGISレイヤ</a><a class="headerlink" href="#postgis-layers" title="Link to this heading"></a></h3>
<p>PostGISレイヤはPostgreSQLデータベースに保存されます。PostGISの利点は、空間インデックス、フィルタリング、クエリする能力です。PostGISを使用すると、selectやidentifyなどのベクタ関数は、QGISのGDALレイヤを使用した場合よりも正確に動作します。</p>
<div class="admonition tip" id="tip-postgis-layers">
<p class="admonition-title">Tip</p>
<p><strong>PostGISレイヤ</strong></p>
<p>通常、PostGISレイヤはgeometry_columnsテーブルのエントリがあることによって識別されます。QGISでは、geometry_columnsテーブルのエントリを持たないレイヤもロードすることができます。これには、テーブルとビューの両方が含まれます。ビューの作成については、PostgreSQLのマニュアルを参照してください。</p>
</div>
<p>このセクションでは、QGISがPostgreSQLレイヤにアクセスする方法について、いくつかの詳細を説明します。ほとんどの場合、QGIS は単純にロード可能なデータベーステーブルのリストをユーザーに提供し、要求に応じてテーブルを読み込むだけです。しかし、PostgreSQLのテーブルをQGISに読み込むことができない場合には、以下の情報がQGISのメッセージを理解するための助けとなり、PostgreSQLのテーブルやビュー定義を修正してQGISで読み込めるようになるための方向性が得られるかもしれません。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>PostgreSQLデータベースにもQGISのプロジェクトを保存できます。</p>
</div>
<section id="primary-key">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">主キー</a><a class="headerlink" href="#primary-key" title="Link to this heading"></a></h4>
<p>QGISは、PostgreSQLレイヤがユニークなキーとして使用できる列を含んでいることを要求します。テーブルの場合、これは通常、テーブルに主キーまたはユニーク制約を持つ列を必要とすることを意味します。QGISでは、この列は int4型（4バイトサイズの整数）である必要があります。または、ctid 列を主キーとして使用することもできます。テーブルにこれらの項目がない場合、oid 列が代わりに使用されます。列にインデックスが作成されると、パフォーマンスが向上します（PostgreSQLでは主キーが自動的にインデックス化されることに注意してください）。</p>
<p>QGISには、デフォルトで有効になっている <strong>idで選択</strong> チェックボックスがあります。このオプションは属性なしのid を取得しますが、多くの場合、これは主キーによる検索よりも高速です。</p>
</section>
<section id="view">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">ビュー</a><a class="headerlink" href="#view" title="Link to this heading"></a></h4>
<p>PostgreSQLのレイヤがビューである場合でも同様の要件がありますが、ビューは必ずしも主キーやユニーク制約のある列を持っているとは限りません。ビューをロードする前に、QGISダイアログで主キーフィールド（整数である必要があります）を定義する必要があります。適切な列がビューに存在しない場合、QGISはレイヤをロードしません。このような場合には、適切な列（整数型で、主キーであるかまたはユニーク制約があり、できればインデックス付き）を確実に含むようにビューを変更することが解決策となります。</p>
<p>テーブルに関しては、 <strong>idで選択</strong> のチェックボックスがデフォルトで有効になっています（チェックボックスの意味については上記参照）。複雑なビューを使用する場合には、このオプションを無効にした方がよいかもしれません。</p>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p><strong>PostgreSQL外部テーブル</strong></p>
<p>PostgreSQL外部テーブルはPostgreSQLプロバイダによって明示的にサポートされてはおらず、ビューのように扱われます。</p>
</div>
</section>
<section id="qgis-layer-style-table-and-database-backup">
<span id="layer-style-backup"></span><h4><a class="toc-backref" href="#id15" role="doc-backlink">QGIS layer_style テーブルとデータベースのバックアップ</a><a class="headerlink" href="#qgis-layer-style-table-and-database-backup" title="Link to this heading"></a></h4>
<p><code class="file docutils literal notranslate"><span class="pre">pg_dump</span></code> コマンドと <code class="file docutils literal notranslate"><span class="pre">pg_restore</span></code> コマンドを使用してPostGISデータベースのバックアップを作成したい場合、QGISで保存されたデフォルトのレイヤスタイルがその後のリストアに失敗する場合には、リストアコマンドの前にXML オプションを <code class="file docutils literal notranslate"><span class="pre">DOCUMENT</span></code> に設定する必要があります。</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">layer_style</span></code> テーブルのPLAINバックアップを作ります</p></li>
<li><p>そのファイルをテキストエディタで開きます</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">xmloption</span> <span class="pre">=</span> <span class="pre">context;</span></code> の行を <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">XML</span> <span class="pre">OPTION</span> <span class="pre">DOCUMENT;</span></code> に変えます</p></li>
<li><p>ファイルを保存します</p></li>
<li><p>psqlを使ってテーブルを新しいデータベースにリストアします</p></li>
</ol>
</section>
<section id="filter-database-side">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">データベース側でのフィルタ</a><a class="headerlink" href="#filter-database-side" title="Link to this heading"></a></h4>
<p>QGISでは、サーバサイドであらかじめ地物をフィルタリングすることができます。 <span class="menuselection">設定 ► オプション ► データソース ►</span> の <a class="reference internal" href="../../../_images/checkbox.png"><img alt="checkbox" src="../../../_images/checkbox.png" style="width: 1.3em;" /></a> <span class="menuselection">可能であればサーバ側で式を実行する</span> にチェックを入れると、サーバ側でフィルタリングされます。データベースに送信されるのは、サポートされている式のみです。サポートされていない演算子や関数を使用した式は、ローカル側での評価に滑らかにフォールバックします。</p>
</section>
<section id="support-of-postgresql-data-types">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">PostgreSQLのデータ型のサポート</a><a class="headerlink" href="#support-of-postgresql-data-types" title="Link to this heading"></a></h4>
<p>PostgreSQLプロバイダでサポートされているデータ型には、以下のものが含まれます：整数、浮動小数点、論理値、バイナリオブジェクト、可変長文字、幾何データ、 日付/時刻、配列、 hstore（キー/バリュー型）、JSON</p>
</section>
</section>
<section id="importing-data-into-postgresql">
<span id="vector-import-data-in-postgis"></span><span id="index-6"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">15.3.2.5. </span>PostgreSQLへデータをインポートする</a><a class="headerlink" href="#importing-data-into-postgresql" title="Link to this heading"></a></h3>
<p>データは、DBマネージャプラグインやコマンドラインツールのshp2pgsql、ogr2ogrなど、いくつかのツールを使用してPostgreSQL/ PostGISにインポートできます。</p>
<section id="db-manager">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">DBマネージャ</a><a class="headerlink" href="#db-manager" title="Link to this heading"></a></h4>
<p>QGISには、 <a class="reference internal" href="../../../_images/dbmanager.png"><img alt="dbManager" src="../../../_images/dbmanager.png" style="width: 1.5em;" /></a> <sup>DBマネージャ</sup> という名前のコアプラグインが付属しています。これはデータをロードするために使用することができ、スキーマもサポートしています。詳細は <a class="reference internal" href="../plugins/core_plugins/plugins_db_manager.html#dbmanager"><span class="std std-ref">DBマネージャプラグイン</span></a> を参照してください。</p>
</section>
<section id="shp2pgsql">
<h4><a class="toc-backref" href="#id20" role="doc-backlink">shp2pgsql</a><a class="headerlink" href="#shp2pgsql" title="Link to this heading"></a></h4>
<p>PostGISには <strong>shp2pgsql</strong> というユーティリティコマンドが含まれており、これを使用してシェープファイル形式のデータセットをPostGIS対応のデータベースにインポートすることができます。例えば、 <code class="file docutils literal notranslate"><span class="pre">lakes.shp</span></code> という名前のシェープファイル形式のデータセットを <code class="docutils literal notranslate"><span class="pre">gis_data</span></code> という名前のPostgreSQLデータベースにインポートするには、次のコマンドを使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shp2pgsql</span> <span class="o">-</span><span class="n">s</span> <span class="mi">2964</span> <span class="n">lakes</span><span class="o">.</span><span class="n">shp</span> <span class="n">lakes_new</span> <span class="o">|</span> <span class="n">psql</span> <span class="n">gis_data</span>
</pre></div>
</div>
<p>これにより、 <code class="docutils literal notranslate"><span class="pre">gis_data</span></code> データベース内に <code class="docutils literal notranslate"><span class="pre">lakes_new</span></code> という名前の新規レイヤが作成されます。この新しいレイヤは空間参照識別子（SRID）が2964になります。空間参照系と投影法についての詳細は、 <a class="reference internal" href="../working_with_projections/working_with_projections.html#label-projections"><span class="std std-ref">投影法の操作</span></a> を参照してください。</p>
<div class="admonition tip" id="tip-export-from-postgis">
<span id="index-7"></span><p class="admonition-title">Tip</p>
<p><strong>PostGISからデータセットをエクスポートする</strong></p>
<p>PostGISのデータセットをシェープファイル形式へとエクスポートするツール <strong>pgsql2shp</strong> もあります。このツールはPostGISディストリビューションに付属しています。</p>
</div>
</section>
<section id="ogr2ogr">
<span id="index-8"></span><h4><a class="toc-backref" href="#id21" role="doc-backlink">ogr2ogr</a><a class="headerlink" href="#ogr2ogr" title="Link to this heading"></a></h4>
<p><strong>shp2pgsql</strong> や <strong>DBマネージャ</strong> の他にも、PostGISにデータを読み込ませるツールがあります。 <strong>ogr2ogr</strong> です。これはGDALのインストールに含まれています。</p>
<p>シェープファイル形式のデータセットをPostGISにインポートするには、次のコマンドを使用します:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogr2ogr</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;PostgreSQL&quot;</span> <span class="n">PG</span><span class="p">:</span><span class="s2">&quot;dbname=postgis host=myhost.de user=postgres</span>
<span class="n">password</span><span class="o">=</span><span class="n">topsecret</span><span class="s2">&quot; alaska.shp</span>
</pre></div>
</div>
<p>このコマンドは、シェープファイル形式のデータセット <code class="file docutils literal notranslate"><span class="pre">alaska.shp</span></code> をホストサーバー <em>myhost.de</em> 上のPostGISデータベース <em>postgis</em> にユーザー <em>postgres</em> 、パスワード <em>topsecret</em> を使用してインポートします。</p>
<p>GDALはPostGISをサポートするためにPostgreSQLと一緒にビルドされなければならないことに注意してください。(<a href="#id1"><span class="problematic" id="id2">|</span></a>nix|で)入力することでこれを確認できます:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ogrinfo</span> <span class="o">--</span><span class="n">formats</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="n">post</span>
</pre></div>
</div>
<p>デフォルトの <strong>INSERT INTO</strong> メソッドの代わりにPostgreSQLの <strong>COPY</strong> コマンドを使用したい場合には、以下の環境変数を設定します（ <a class="reference internal" href="../../../_images/nix.png"><img alt="nix" src="../../../_images/nix.png" style="width: 1em;" /></a> と <a class="reference internal" href="../../../_images/osx.png"><img alt="osx" src="../../../_images/osx.png" style="width: 1em;" /></a> では利用可能）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">PG_USE_COPY</span><span class="o">=</span><span class="n">YES</span>
</pre></div>
</div>
<p><strong>shp2pgsl</strong> は空間インデックスを作成しますが、 <strong>ogr2ogr</strong> では空間インデックスを作成しません。インポート後に追加のステップとして、通常のSQLコマンド <strong>CREATE INDEX</strong> を使用して手動でインデックスを作成する必要があります（次のセクション <a class="reference internal" href="#vector-improving-performance"><span class="std std-ref">パフォーマンスの改善</span></a> で説明します）。</p>
</section>
<section id="improving-performance">
<span id="vector-improving-performance"></span><span id="index-9"></span><h4><a class="toc-backref" href="#id22" role="doc-backlink">パフォーマンスの改善</a><a class="headerlink" href="#improving-performance" title="Link to this heading"></a></h4>
<p>PostgreSQLデータベースからの地物の取得は、特にネットワーク経由では時間がかかります。データベース内の各レイヤにPostGIS空間インデックスがあることで、PostgreSQLレイヤの描画パフォーマンスを向上させることができます。PostGISは空間検索を高速化するためにGiST (Generalized Search Tree) インデックスの作成をサポートしています（GiSTインデックスの情報は <a class="reference external" href="https://postgis.net">https://postgis.net</a> にあるPostGISドキュメントから引用しています）。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>レイヤのインデックス作成にはDBマネージャを使用することができます。最初にレイヤを選択し、 <span class="menuselection">テーブル ► テーブルの編集</span> をクリックして、 <span class="menuselection">インデックス</span> タブを開き、 <span class="guilabel">空間インデックスの追加</span> ボタンを押します。</p>
</div>
<p>GiSTインデックスを作成するための構文は以下のとおりです:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">INDEX</span> <span class="p">[</span><span class="n">indexname</span><span class="p">]</span> <span class="n">ON</span> <span class="p">[</span><span class="n">tablename</span><span class="p">]</span>
  <span class="n">USING</span> <span class="n">GIST</span> <span class="p">(</span> <span class="p">[</span><span class="n">geometryfield</span><span class="p">]</span> <span class="n">GIST_GEOMETRY_OPS</span> <span class="p">);</span>
</pre></div>
</div>
<p>巨大なテーブルでは、インデックスの作成には長時間かかることに注意してください。インデックスが作成されたら、 <code class="docutils literal notranslate"><span class="pre">VACUUM</span> <span class="pre">ANALYZE</span></code> を実行してください。詳細な情報については、PostGISドキュメント（ <a class="reference internal" href="../literature_web/literature_and_web_references.html#literature-and-web"><span class="std std-ref">文献とWeb参照</span></a> のPOSTGIS-PROJECT ）を参照してください。</p>
<p>下記の例では、GiSTインデックスを作成しています:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gsherman@madison:~/current$ psql gis_data
Welcome to psql 8.3.0, the PostgreSQL interactive terminal.

Type:  \copyright for distribution terms
       \h for help with SQL commands
       \? for help with psql commands
       \g or terminate with semicolon to execute query
       \q to quit

gis_data=# CREATE INDEX sidx_alaska_lakes ON alaska_lakes
gis_data-# USING GIST (the_geom GIST_GEOMETRY_OPS);
CREATE INDEX
gis_data=# VACUUM ANALYZE alaska_lakes;
VACUUM
gis_data=# \q
gsherman@madison:~/current$
</pre></div>
</div>
</section>
</section>
<section id="spatialite-layers">
<span id="spatialite-data"></span><span id="index-10"></span><h3><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">15.3.2.6. </span>SpatiaLiteレイヤ</a><a class="headerlink" href="#spatialite-layers" title="Link to this heading"></a></h3>
<p>ベクタレイヤをSpatiaLite形式で保存したい場合には、 <a class="reference internal" href="create_layers.html#general-saveas"><span class="std std-ref">既存のレイヤから新しいレイヤを作成する</span></a> の説明に従ってください。 <span class="guilabel">形式</span> として <code class="docutils literal notranslate"><span class="pre">SpatiaLite</span></code> を選択し、 <span class="guilabel">ファイル名</span> と <span class="guilabel">レイヤ名</span> を入力してください。</p>
<p>また、形式として <code class="docutils literal notranslate"><span class="pre">SQLite</span></code> を選択し、 <span class="menuselection">カスタムオプション ► データソース</span> フィールドに <a href="#id1"><span class="problematic" id="id2">``</span></a>SPATIALITE=YES``を追加することでもSpatiaLite形式で保存できます。このカスタムオプションは、GDALにSpatiaLiteデータベースを作成するように指示します。 <a class="reference external" href="https://gdal.org/drivers/vector/sqlite.html">https://gdal.org/drivers/vector/sqlite.html</a> も参照してください。</p>
<p>QGISはSpatiaLiteで編集可能なビューもサポートしています。SpatiaLiteデータの管理には、 <a class="reference internal" href="../plugins/core_plugins/plugins_db_manager.html#dbmanager"><span class="std std-ref">DBマネージャ</span></a> コアプラグインを使用することもできます。</p>
<p>新しいSpatiaLiteレイヤを作成したい場合は <a class="reference internal" href="create_layers.html#vector-create-spatialite"><span class="std std-ref">新しいSpatiaLiteレイヤを作成する</span></a> を参照して下さい。</p>
</section>
<section id="geojson-specific-parameters">
<span id="export-geojson-files"></span><span id="index-11"></span><h3><a class="toc-backref" href="#id24" role="doc-backlink"><span class="section-number">15.3.2.7. </span>GeoJSONに特有のパラメータ</a><a class="headerlink" href="#geojson-specific-parameters" title="Link to this heading"></a></h3>
<p>GeoJSON形式で <a class="reference internal" href="create_layers.html#general-saveas"><span class="std std-ref">レイヤをエクスポートする</span></a> 場合、いくつか特有の <span class="guilabel">レイヤオプション</span> があります。これらのオプションは、ファイルに書き出すGDALのオプションに由来するものです：</p>
<ul class="simple">
<li><p><span class="guilabel">COORDINATE_PRECISION</span> 座標を書き込む際の小数点区切り文字以下の最大桁数を指定します。デフォルトは15です（注：緯度経度座標の場合には6で十分です）。末尾に続くゼロは切り捨てられます。</p></li>
<li><p><span class="guilabel">RFC7946</span> デフォルトではGeoJSON 2008が使用されます。この値がYESに設定されると、更新されたRFC 7946標準が使用されます。デフォルトはNOです（従ってGeoJSON 2008が使用されます）。 主な違いについては <a class="reference external" href="https://gdal.org/drivers/vector/geojson.html#rfc-7946-write-support">https://gdal.org/drivers/vector/geojson.html#rfc-7946-write-support</a> を参照してください。簡単に言えば、RFC 7946標準ではEPSG:4326のみが許可され、他のCRSは変換されます。また、ポリゴンは向きの右手ルールに従うように書かれ、&quot;bbox&quot; 配列の値は [west, south, east, north] であり、[minx, miny, maxx, maxy] ではありません。そして、FeatureCollection、Feature、Geometryオブジェクトではいくつかの拡張メンバ名が禁止されており、デフォルトの座標精度は10進数で7桁です。</p></li>
<li><p><span class="guilabel">WRITE_BBOX</span> をYESに設定すると、地物や地物コレクションのレベルでジオメトリのバウンディングボックスを含めます。</p></li>
</ul>
<p>GeoJSONの他に、&quot;GeoJSON - Newline Delimited&quot; （ <a class="reference external" href="https://gdal.org/drivers/vector/geojsonseq.html">https://gdal.org/drivers/vector/geojsonseq.html</a> 参照）へと出力するオプションもあります。フィーチャーコレクションのフィーチャーの代わりに、1種類のもの（おそらくは単一のフィーチャー）を改行区切りで連続的に並べます。</p>
<p>GeoJSON - Newline Delimited にもいくつかの特有のレイヤオプションがあります。</p>
<ul class="simple">
<li><p><span class="guilabel">COORDINATE_PRECISION</span> 上記を参照してください（GeoJSONのものと同様です）。</p></li>
<li><p><span class="guilabel">RS</span> レコードの開始を RS=0x1E の文字とするかどうかを決めます。違いは、フィーチャーがどのように区切られるかにあります。 改行（LF）文字のみ（Newline Delimited JSON, geojsonl）か、レコード区切り（RS）文字がレコードの前に置かれて改行文字で区切られるか（GeoJSON Text Sequences, geojsons）です。 デフォルトはNOです。拡張子が指定されない場合は、ファイルに <code class="file docutils literal notranslate"><span class="pre">.json</span></code> 拡張子が付きます。</p></li>
</ul>
</section>
<section id="sap-hana-spatial-layers">
<span id="label-hana-spatial"></span><span id="index-12"></span><h3><a class="toc-backref" href="#id25" role="doc-backlink"><span class="section-number">15.3.2.8. </span>SAP HANA空間レイヤ</a><a class="headerlink" href="#sap-hana-spatial-layers" title="Link to this heading"></a></h3>
<p>このセクションでは、QGISがSAP HANAのレイヤにアクセスする方法について、いくつかの詳細を説明します。ほとんどの場合、QGISは単純にロード可能なデータベーステーブルのリストをユーザーに提供し、要求に応じてテーブルを読み込むだけです。しかし、SAP HANAのテーブルまたはビューをQGISに読み込むことができない場合には、以下の情報が参考となり、根本的な原因を理解し問題解決の助けとなるでしょう。</p>
<section id="feature-identification">
<h4><a class="toc-backref" href="#id26" role="doc-backlink">地物の識別</a><a class="headerlink" href="#feature-identification" title="Link to this heading"></a></h4>
<p>QGISの地物編集機能の全てを利用したい場合には、QGISがレイヤ内の各地物を明確に識別できる必要があります。内部的には、QGISは地物の識別に64ビットの符号付き整数を使用します。負の値の範囲は特別な目的のために予約されています。</p>
<p>従って、QGISの地物編集機能を完全にサポートするためには、SAP HANAプロバイダには64ビットの正の整数にマッピングできるユニークキーが必要です。もしもこのようなマッピングを作成できない場合には、地物を表示することはできますが、編集できない可能性があります。</p>
</section>
<section id="adding-tables">
<h4><a class="toc-backref" href="#id27" role="doc-backlink">テーブルの追加</a><a class="headerlink" href="#adding-tables" title="Link to this heading"></a></h4>
<p>レイヤとしてテーブルを追加する際に、SAP HANAプロバイダはテーブルの主キーを使用して、主キーをユニークな地物IDにマッピングします。 従って、地物編集機能を完全にサポートするためには、テーブルの定義に主キーが必要です。</p>
<p>SAP HANAプロバイダはマルチカラムの主キーをサポートしていますが、ベストな性能を得たい場合には、主キーは <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code> 型の単一カラムとしてください。</p>
</section>
<section id="adding-views">
<h4><a class="toc-backref" href="#id28" role="doc-backlink">ビューの追加</a><a class="headerlink" href="#adding-views" title="Link to this heading"></a></h4>
<p>レイヤとしてビューを追加する際に、SAP HANAプロバイダは地物を一義的に特定するカラムを自動的に特定することはありません。さらに、一部のビューは読み取り専用で、編集できません。</p>
<p>地物編集機能を完全にサポートするためには、ビューは更新可能である必要があり（システムビュー <code class="docutils literal notranslate"><span class="pre">SYS.VIEWS</span></code> において、問題となっているビューのカラムの <code class="docutils literal notranslate"><span class="pre">IS_READ_ONLY</span></code> を確認してください）、地物を識別するための一つ以上のカラムをQGISで手動で指定する必要があります。このカラムは、 <span class="menuselection">レイヤ ► レイヤを追加 ► SAP HANA空間レイヤを追加</span> を使用して、 <span class="guilabel">地物ID</span> カラムで選択することで指定できます。ベストな性能を得たい場合には、 <span class="guilabel">地物ID</span> の値は単一の <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code> 型のカラムとしてください。</p>
</section>
</section>
</section>
<section id="layers-crossing-180-longitude">
<span id="index-13"></span><h2><a class="toc-backref" href="#id29" role="doc-backlink"><span class="section-number">15.3.3. </span>経度 180° をまたぐレイヤ</a><a class="headerlink" href="#layers-crossing-180-longitude" title="Link to this heading"></a></h2>
<p>多くのGISパッケージは、地理参照系（緯度経度）が180度の経線を越えるレイヤをラップしません。その結果、このようなレイヤをQGISで開くと、近くに表示されるはずの2つの場所が大きく離れて表示されることがあります。<a class="reference internal" href="#figure-vector-crossing"><span class="std std-numref">図 15.31</span></a> では、マップキャンバスの左端にある小さな点（チャタム諸島）は、ニュージーランド本島の右側のグリッド内にあるはずです。</p>
<figure class="align-center" id="id3">
<span id="figure-vector-crossing"></span><img alt="../../../_images/vectorNotWrapping.png" src="../../../_images/vectorNotWrapping.png" />
<figcaption>
<p><span class="caption-number">図 15.31 </span><span class="caption-text">180° 経線をまたぐ緯度経度による地図</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="solving-in-postgis">
<h3><a class="toc-backref" href="#id30" role="doc-backlink"><span class="section-number">15.3.3.1. </span>PostGISで解決する</a><a class="headerlink" href="#solving-in-postgis" title="Link to this heading"></a></h3>
<p>回避策として、PostGIS と <a class="reference external" href="https://postgis.net/docs/ST_Shift_Longitude.html">ST_ShiftLongitude</a> 関数を使用して経度値を変換する方法があります。この関数は、ジオメトリ内のすべての地物のすべてのコンポーネントのすべての点/頂点を読み取り、その経度座標を -180...0°から180...360°に、そしてその逆にシフトします。この関数は対称であるため、結果は-180...180°のデータを0...360°で表現し、0...360°のデータを-180...180°で表現します。</p>
<figure class="align-center" id="id4">
<span id="figure-vector-crossing-map"></span><a class="reference internal image-reference" href="../../../_images/vectorWrapping.png"><img alt="../../../_images/vectorWrapping.png" src="../../../_images/vectorWrapping.png" style="width: 25em;" /></a>
<figcaption>
<p><span class="caption-number">図 15.32 </span><span class="caption-text"><strong>ST_ShiftLongitude</strong> 関数を適用した経度180°越え</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<ol class="arabic">
<li><p>例えばDBマネージャプラグインを使用して、データをPostGISにインポートします（ <a class="reference internal" href="#vector-import-data-in-postgis"><span class="std std-ref">PostgreSQLへデータをインポートする</span></a> 参照）。</p></li>
<li><p>PostGISのコマンドラインインターフェイスを使って、以下のコマンドを実行します：</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- In this example, &quot;TABLE&quot; is the actual name of your PostGIS table</span>
<span class="k">update</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="n">ST_ShiftLongitude</span><span class="p">(</span><span class="n">geom</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>すべてうまくいくと、更新された地物の数についての確認が表示されます。その後、地図を読み込むと違いを確認できます（ <a class="reference internal" href="#figure-vector-crossing-map">Figure_vector_crossing_map</a> ）。</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="create_layers.html" class="btn btn-neutral float-left" title="15.2. レイヤを作成する" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../working_with_vector/index.html" class="btn btn-neutral float-right" title="16. ベクタデータの操作" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">最終更新: 2024 5月 30, 01:33 +0900
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages:
Expected French translation link for https://docs.qgis.org/3.28/en/docs/user_manual/print_composer/overview_composer.html
would return https://app.transifex.com/qgis/qgis-documentation/translate/#fr/aa6d8bc653526d38b295ca94bf8eee5e
with the md5 value of "github#qgis/QGIS-Documentation#release_3.28#locale/en/LC_MESSAGES/docs/user_manual/print_composer/overview_composer.po"-->
<!--Make sure that mismatching language codes between Transifex and Sphinx are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: 3.34
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/en/docs/user_manual/managing_data_source/supported_data.html">en</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/cs/docs/user_manual/managing_data_source/supported_data.html">cs</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/de/docs/user_manual/managing_data_source/supported_data.html">de</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/es/docs/user_manual/managing_data_source/supported_data.html">es</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/fr/docs/user_manual/managing_data_source/supported_data.html">fr</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/hu/docs/user_manual/managing_data_source/supported_data.html">hu</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/it/docs/user_manual/managing_data_source/supported_data.html">it</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ja/docs/user_manual/managing_data_source/supported_data.html">ja</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ko/docs/user_manual/managing_data_source/supported_data.html">ko</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/lt/docs/user_manual/managing_data_source/supported_data.html">lt</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/nl/docs/user_manual/managing_data_source/supported_data.html">nl</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_BR/docs/user_manual/managing_data_source/supported_data.html">pt_BR</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_PT/docs/user_manual/managing_data_source/supported_data.html">pt_PT</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ro/docs/user_manual/managing_data_source/supported_data.html">ro</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ru/docs/user_manual/managing_data_source/supported_data.html">ru</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zh-Hans/docs/user_manual/managing_data_source/supported_data.html">zh-Hans</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/ja/docs/user_manual/managing_data_source/supported_data.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/ja/docs/user_manual/managing_data_source/supported_data.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ja/docs/user_manual/managing_data_source/supported_data.html">3.34</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.28/ja/docs/user_manual/managing_data_source/supported_data.html">3.28</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.22/ja/docs/user_manual/managing_data_source/supported_data.html">3.22</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/ja/docs/user_manual/managing_data_source/supported_data.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/ja/docs/user_manual/managing_data_source/supported_data.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/ja/docs/user_manual/managing_data_source/supported_data.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/ja/docs/user_manual/managing_data_source/supported_data.html">2.18</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/user_manual/managing_data_source/supported_data.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://app.transifex.com/qgis/qgis-documentation/translate/#ja/3ea468d075af07581c8a234b4385e77a" target="_blank" rel="noopener noreferrer">Translate Page</a>
          </dd>
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/ja" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/3.34" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/3.34" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/release-3_34" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>