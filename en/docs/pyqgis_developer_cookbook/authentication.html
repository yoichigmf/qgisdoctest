<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14. Authentication infrastructure &mdash; QGIS Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/qgis_docs.css?v=5415a924" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />

  
    <link rel="shortcut icon" href="../../_static/qgis_logo.ico"/>
    <link rel="canonical" href="https://docs.qgis.org/latest/en/docs/pyqgis_developer_cookbook/authentication.html"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15. Tasks - doing heavy work in the background" href="tasks.html" />
    <link rel="prev" title="13. Communicating with the user" href="communicating.html" />
  <meta name="description" content="QGIS 3.34 documentation: 14. Authentication infrastructure">
</head>

<body class="wy-body-for-nav">

  <nav class="release_status_topbar">
  </nav>

   

 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
   

          
          
          <a href="../index.html" class="icon icon-home">
            QGIS Documentation
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.34
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
   <a href= "../../genindex.html">Index</a>
 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">For Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/index.html">QGIS Desktop User Guide/Manual (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_manual/index.html">QGIS Server Guide/Manual (QGIS 3.34)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training_manual/index.html">Training Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gentle_gis_introduction/index.html">A Gentle Introduction to GIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Writers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation_guidelines/index.html">Documentation Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PyQGIS Cookbook (QGIS 3.34)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadproject.html">2. Loading Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="loadlayer.html">3. Loading Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="legend.html">4. Accessing the Table Of Contents (TOC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="raster.html">5. Using Raster Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="vector.html">6. Using Vector Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">7. Geometry Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="crs.html">8. Projections Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="canvas.html">9. Using the Map Canvas</a></li>
<li class="toctree-l2"><a class="reference internal" href="composer.html">10. Map Rendering and Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="expressions.html">11. Expressions, Filtering and Calculating Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">12. Reading And Storing Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="communicating.html">13. Communicating with the user</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">14. Authentication infrastructure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">14.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#glossary">14.2. Glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qgsauthmanager-the-entry-point">14.3. QgsAuthManager the entry point</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#init-the-manager-and-set-the-master-password">14.3.1. Init the manager and set the master password</a></li>
<li class="toctree-l4"><a class="reference internal" href="#populate-authdb-with-a-new-authentication-configuration-entry">14.3.2. Populate authdb with a new Authentication Configuration entry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-an-entry-from-authdb">14.3.3. Remove an entry from authdb</a></li>
<li class="toctree-l4"><a class="reference internal" href="#leave-authcfg-expansion-to-qgsauthmanager">14.3.4. Leave authcfg expansion to QgsAuthManager</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adapt-plugins-to-use-authentication-infrastructure">14.4. Adapt plugins to use Authentication infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#authentication-guis">14.5. Authentication GUIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gui-to-select-credentials">14.5.1. GUI to select credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authentication-editor-gui">14.5.2. Authentication Editor GUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authorities-editor-gui">14.5.3. Authorities Editor GUI</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">15. Tasks - doing heavy work in the background</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/index.html">16. Developing Python Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing.html">17. Writing a Processing plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="pluginlayer.html">18. Using Plugin Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_analysis.html">19. Network analysis library</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.html">20. QGIS Server and Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="cheat_sheet.html">21. Cheat sheet for PyQGIS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/index.html">Developers Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QGIS Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">PyQGIS Developer Cookbook</a></li>
      <li class="breadcrumb-item active"><span class="section-number">14. </span>Authentication infrastructure</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/qgis/QGIS-Documentation/blob/master/docs/pyqgis_developer_cookbook/authentication.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="communicating.html" class="btn btn-neutral float-left" title="13. Communicating with the user" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tasks.html" class="btn btn-neutral float-right" title="15. Tasks - doing heavy work in the background" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <blockquote>
<div></div></blockquote>
<section id="authentication-infrastructure">
<span id="index-0"></span><span id="id1"></span><h1><span class="section-number">14. </span>Authentication infrastructure<a class="headerlink" href="#authentication-infrastructure" title="Link to this heading"></a></h1>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The code snippets on this page need the following imports if you’re outside the pyqgis console:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 2</span>  <span class="n">QgsApplication</span><span class="p">,</span>
<span class="linenos"> 3</span>  <span class="n">QgsRasterLayer</span><span class="p">,</span>
<span class="linenos"> 4</span>  <span class="n">QgsAuthMethodConfig</span><span class="p">,</span>
<span class="linenos"> 5</span>  <span class="n">QgsDataSourceUri</span><span class="p">,</span>
<span class="linenos"> 6</span>  <span class="n">QgsPkiBundle</span><span class="p">,</span>
<span class="linenos"> 7</span>  <span class="n">QgsMessageLog</span><span class="p">,</span>
<span class="linenos"> 8</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="kn">from</span> <span class="nn">qgis.gui</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos">11</span>    <span class="n">QgsAuthAuthoritiesEditor</span><span class="p">,</span>
<span class="linenos">12</span>    <span class="n">QgsAuthConfigEditor</span><span class="p">,</span>
<span class="linenos">13</span>    <span class="n">QgsAuthConfigSelect</span><span class="p">,</span>
<span class="linenos">14</span>    <span class="n">QgsAuthSettingsWidget</span><span class="p">,</span>
<span class="linenos">15</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="kn">from</span> <span class="nn">qgis.PyQt.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos">18</span>    <span class="n">QWidget</span><span class="p">,</span>
<span class="linenos">19</span>    <span class="n">QTabWidget</span><span class="p">,</span>
<span class="linenos">20</span><span class="p">)</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="kn">from</span> <span class="nn">qgis.PyQt.QtNetwork</span> <span class="kn">import</span> <span class="n">QSslCertificate</span>
</pre></div>
</div>
</div>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id11">Introduction</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id12">Glossary</a></p></li>
<li><p><a class="reference internal" href="#qgsauthmanager-the-entry-point" id="id13">QgsAuthManager the entry point</a></p>
<ul>
<li><p><a class="reference internal" href="#init-the-manager-and-set-the-master-password" id="id14">Init the manager and set the master password</a></p></li>
<li><p><a class="reference internal" href="#populate-authdb-with-a-new-authentication-configuration-entry" id="id15">Populate authdb with a new Authentication Configuration entry</a></p>
<ul>
<li><p><a class="reference internal" href="#available-authentication-methods" id="id16">Available Authentication methods</a></p></li>
<li><p><a class="reference internal" href="#populate-authorities" id="id17">Populate Authorities</a></p></li>
<li><p><a class="reference internal" href="#manage-pki-bundles-with-qgspkibundle" id="id18">Manage PKI bundles with QgsPkiBundle</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#remove-an-entry-from-authdb" id="id19">Remove an entry from authdb</a></p></li>
<li><p><a class="reference internal" href="#leave-authcfg-expansion-to-qgsauthmanager" id="id20">Leave authcfg expansion to QgsAuthManager</a></p>
<ul>
<li><p><a class="reference internal" href="#pki-examples-with-other-data-providers" id="id21">PKI examples with other data providers</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#adapt-plugins-to-use-authentication-infrastructure" id="id22">Adapt plugins to use Authentication infrastructure</a></p></li>
<li><p><a class="reference internal" href="#authentication-guis" id="id23">Authentication GUIs</a></p>
<ul>
<li><p><a class="reference internal" href="#gui-to-select-credentials" id="id24">GUI to select credentials</a></p></li>
<li><p><a class="reference internal" href="#authentication-editor-gui" id="id25">Authentication Editor GUI</a></p></li>
<li><p><a class="reference internal" href="#authorities-editor-gui" id="id26">Authorities Editor GUI</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<span id="authentication-introduction"></span><h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">14.1. </span>Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>User reference of the Authentication infrastructure can be read
in the  User Manual in the <a class="reference internal" href="../user_manual/auth_system/auth_overview.html#authentication-overview"><span class="std std-ref">Authentication System Overview</span></a> paragraph.</p>
<p>This chapter describes the best practices to use the Authentication system from
a developer perspective.</p>
<p>The authentication system is widely used in QGIS Desktop by data providers whenever
credentials are required to access a particular resource, for example when a layer
establishes a connection to a Postgres database.</p>
<p>There are also a few widgets in the QGIS gui library that plugin developers can use to
easily integrate the authentication infrastructure into their code:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigEditor.html#qgis.gui.QgsAuthConfigEditor" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigEditor</span></code></a></p></li>
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigSelect.html#qgis.gui.QgsAuthConfigSelect" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigSelect</span></code></a></p></li>
<li><p><a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthSettingsWidget.html#qgis.gui.QgsAuthSettingsWidget" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthSettingsWidget</span></code></a></p></li>
</ul>
<p>A good code reference can be read from the authentication infrastructure
<a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_qgsauthsystem.py">tests code</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Due to the security constraints that were taken into account during the authentication
infrastructure design, only a selected subset of the internal methods are exposed to Python.</p>
</div>
</section>
<section id="glossary">
<span id="authentication-manager-glossary"></span><h2><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">14.2. </span>Glossary</a><a class="headerlink" href="#glossary" title="Link to this heading"></a></h2>
<p>Here are some definition of the most common objects treated in this chapter.</p>
<dl class="simple glossary">
<dt id="term-Master-Password">Master Password<a class="headerlink" href="#term-Master-Password" title="Link to this term"></a></dt><dd><p>Password to allow access and decrypt credential stored in the QGIS
Authentication DB</p>
</dd>
<dt id="term-Authentication-Database">Authentication Database<a class="headerlink" href="#term-Authentication-Database" title="Link to this term"></a></dt><dd><p>A <a class="reference internal" href="#term-Master-Password"><span class="xref std std-term">Master Password</span></a> crypted sqlite db <code class="file docutils literal notranslate"><span class="pre">qgis-auth.db</span></code>
where <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> are stored. e.g user/password,
personal certificates and keys, Certificate Authorities</p>
</dd>
<dt id="term-Authentication-DB">Authentication DB<a class="headerlink" href="#term-Authentication-DB" title="Link to this term"></a></dt><dd><p><a class="reference internal" href="#term-Authentication-Database"><span class="xref std std-term">Authentication Database</span></a></p>
</dd>
<dt id="term-Authentication-Configuration">Authentication Configuration<a class="headerlink" href="#term-Authentication-Configuration" title="Link to this term"></a></dt><dd><p>A set of authentication data depending on <a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a>.
e.g Basic authentication method stores the couple of user/password.</p>
</dd>
<dt id="term-Authentication-Config">Authentication Config<a class="headerlink" href="#term-Authentication-Config" title="Link to this term"></a></dt><dd><p><a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a></p>
</dd>
<dt id="term-Authentication-Method">Authentication Method<a class="headerlink" href="#term-Authentication-Method" title="Link to this term"></a></dt><dd><p>A specific method used to get authenticated. Each method has its own
protocol used to gain the authenticated level. Each method is implemented
as shared library loaded dynamically during QGIS authentication
infrastructure init.</p>
</dd>
</dl>
</section>
<section id="qgsauthmanager-the-entry-point">
<span id="id2"></span><h2><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">14.3. </span>QgsAuthManager the entry point</a><a class="headerlink" href="#qgsauthmanager-the-entry-point" title="Link to this heading"></a></h2>
<p>The <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthManager</span></code></a> singleton
is the entry point to use the credentials stored in the QGIS encrypted
<a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a>, i.e. the <code class="file docutils literal notranslate"><span class="pre">qgis-auth.db</span></code> file under the
active <a class="reference internal" href="../user_manual/introduction/qgis_configuration.html#user-profiles"><span class="std std-ref">user profile</span></a> folder.</p>
<p>This class takes care of the user interaction: by asking to set a master
password or by transparently using it to access encrypted stored information.</p>
<section id="init-the-manager-and-set-the-master-password">
<span id="init-manager-and-set-master-password"></span><h3><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">14.3.1. </span>Init the manager and set the master password</a><a class="headerlink" href="#init-the-manager-and-set-the-master-password" title="Link to this heading"></a></h3>
<p>The following snippet gives an example to set master password to open the
access to the authentication settings. Code comments are important to
understand the snippet.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># check if QgsAuthManager has already been initialized... a side effect</span>
<span class="linenos"> 4</span><span class="c1"># of the QgsAuthManager.init() is that AuthDbPath is set.</span>
<span class="linenos"> 5</span><span class="c1"># QgsAuthManager.init() is executed during QGIS application init and hence</span>
<span class="linenos"> 6</span><span class="c1"># you do not normally need to call it directly.</span>
<span class="linenos"> 7</span><span class="k">if</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">authenticationDatabasePath</span><span class="p">():</span>
<span class="linenos"> 8</span>    <span class="c1"># already initialized =&gt; we are inside a QGIS app.</span>
<span class="linenos"> 9</span>    <span class="k">if</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">masterPasswordIsSet</span><span class="p">():</span>
<span class="linenos">10</span>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Authentication master password not recognized&#39;</span>
<span class="linenos">11</span>        <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">masterPasswordSame</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">12</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Master password could not be set&#39;</span>
<span class="linenos">14</span>        <span class="c1"># The verify parameter checks if the hash of the password was</span>
<span class="linenos">15</span>        <span class="c1"># already saved in the authentication db</span>
<span class="linenos">16</span>        <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">setMasterPassword</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">,</span>
<span class="linenos">17</span>                                          <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">18</span><span class="k">else</span><span class="p">:</span>
<span class="linenos">19</span>    <span class="c1"># outside qgis, e.g. in a testing environment =&gt; setup env var before</span>
<span class="linenos">20</span>    <span class="c1"># db init</span>
<span class="linenos">21</span>    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;QGIS_AUTH_DB_DIR_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/path/where/located/qgis-auth.db&quot;</span>
<span class="linenos">22</span>    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Master password could not be set&#39;</span>
<span class="linenos">23</span>    <span class="k">assert</span> <span class="n">authMgr</span><span class="o">.</span><span class="n">setMasterPassword</span><span class="p">(</span><span class="s2">&quot;your master password&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="n">msg</span>
<span class="linenos">24</span>    <span class="n">authMgr</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;/path/where/located/qgis-auth.db&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="populate-authdb-with-a-new-authentication-configuration-entry">
<span id="populate-authdb-with-a-new-auth-entry"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">14.3.2. </span>Populate authdb with a new Authentication Configuration entry</a><a class="headerlink" href="#populate-authdb-with-a-new-authentication-configuration-entry" title="Link to this heading"></a></h3>
<p>Any stored credential is a <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> instance of the
<a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethodConfig.html#qgis.core.QgsAuthMethodConfig" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethodConfig</span></code></a>
class accessed using a unique string like the following one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authcfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
</pre></div>
</div>
<p>that string is generated automatically when creating an entry using the QGIS API or
GUI, but it might be useful to manually set it to a known value in case the
configuration must be shared (with different credentials) between multiple users within
an organization.</p>
<p><a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethodConfig.html#qgis.core.QgsAuthMethodConfig" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethodConfig</span></code></a> is the base class
for any <a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a>.
Any Authentication Method sets a configuration hash map where authentication
information will be stored. Hereafter a useful snippet to store PKI-path
credentials for a hypothetical alice user:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos"> 2</span><span class="c1"># set alice PKI data</span>
<span class="linenos"> 3</span><span class="n">config</span> <span class="o">=</span> <span class="n">QgsAuthMethodConfig</span><span class="p">()</span>
<span class="linenos"> 4</span><span class="n">config</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="s2">&quot;alice&quot;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="n">config</span><span class="o">.</span><span class="n">setMethod</span><span class="p">(</span><span class="s2">&quot;PKI-Paths&quot;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">config</span><span class="o">.</span><span class="n">setUri</span><span class="p">(</span><span class="s2">&quot;https://example.com&quot;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">config</span><span class="o">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s2">&quot;certpath&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/alice-cert.pem&quot;</span> <span class="p">)</span>
<span class="linenos"> 8</span><span class="n">config</span><span class="o">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s2">&quot;keypath&quot;</span><span class="p">,</span> <span class="s2">&quot;path/to/alice-key.pem&quot;</span> <span class="p">)</span>
<span class="linenos"> 9</span><span class="c1"># check if method parameters are correctly set</span>
<span class="linenos">10</span><span class="k">assert</span> <span class="n">config</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># register alice data in authdb returning the ``authcfg`` of the stored</span>
<span class="linenos">13</span><span class="c1"># configuration</span>
<span class="linenos">14</span><span class="n">authMgr</span><span class="o">.</span><span class="n">storeAuthenticationConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">newAuthCfgId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">id</span><span class="p">()</span>
<span class="linenos">16</span><span class="k">assert</span> <span class="n">newAuthCfgId</span>
</pre></div>
</div>
<section id="available-authentication-methods">
<span id="available-auth-methods"></span><h4><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">14.3.2.1. </span>Available Authentication methods</a><a class="headerlink" href="#available-authentication-methods" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a> libraries are loaded dynamically during
authentication manager init. Available authentication methods are:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Basic</span></code> User and password authentication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EsriToken</span></code> ESRI token based authentication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Identity-Cert</span></code> Identity certificate authentication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OAuth2</span></code> OAuth2 authentication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PKI-Paths</span></code> PKI paths authentication</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PKI-PKCS#12</span></code> PKI PKCS#12 authentication</p></li>
</ol>
</section>
<section id="populate-authorities">
<span id="id3"></span><h4><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">14.3.2.2. </span>Populate Authorities</a><a class="headerlink" href="#populate-authorities" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="linenos">2</span><span class="c1"># add authorities</span>
<span class="linenos">3</span><span class="n">cacerts</span> <span class="o">=</span> <span class="n">QSslCertificate</span><span class="o">.</span><span class="n">fromPath</span><span class="p">(</span> <span class="s2">&quot;/path/to/ca_chains.pem&quot;</span> <span class="p">)</span>
<span class="linenos">4</span><span class="k">assert</span> <span class="n">cacerts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="linenos">5</span><span class="c1"># store CA</span>
<span class="linenos">6</span><span class="n">authMgr</span><span class="o">.</span><span class="n">storeCertAuthorities</span><span class="p">(</span><span class="n">cacerts</span><span class="p">)</span>
<span class="linenos">7</span><span class="c1"># and rebuild CA caches</span>
<span class="linenos">8</span><span class="n">authMgr</span><span class="o">.</span><span class="n">rebuildCaCertsCache</span><span class="p">()</span>
<span class="linenos">9</span><span class="n">authMgr</span><span class="o">.</span><span class="n">rebuildTrustedCaCertsCache</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="manage-pki-bundles-with-qgspkibundle">
<span id="id4"></span><h4><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">14.3.2.3. </span>Manage PKI bundles with QgsPkiBundle</a><a class="headerlink" href="#manage-pki-bundles-with-qgspkibundle" title="Link to this heading"></a></h4>
<p>A convenience class to pack PKI bundles composed on SslCert, SslKey and CA
chain is the <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsPkiBundle.html#qgis.core.QgsPkiBundle" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsPkiBundle</span></code></a>
class. Hereafter a snippet to get password protected:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># add alice cert in case of key with pwd</span>
<span class="linenos">2</span><span class="n">caBundlesList</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of CA bundles</span>
<span class="linenos">3</span><span class="n">bundle</span> <span class="o">=</span> <span class="n">QgsPkiBundle</span><span class="o">.</span><span class="n">fromPemPaths</span><span class="p">(</span> <span class="s2">&quot;/path/to/alice-cert.pem&quot;</span><span class="p">,</span>
<span class="linenos">4</span>                                     <span class="s2">&quot;/path/to/alice-key_w-pass.pem&quot;</span><span class="p">,</span>
<span class="linenos">5</span>                                     <span class="s2">&quot;unlock_pwd&quot;</span><span class="p">,</span>
<span class="linenos">6</span>                                     <span class="n">caBundlesList</span> <span class="p">)</span>
<span class="linenos">7</span><span class="k">assert</span> <span class="n">bundle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="linenos">8</span><span class="c1"># You can check bundle validity by calling:</span>
<span class="linenos">9</span><span class="c1"># bundle.isValid()</span>
</pre></div>
</div>
<p>Refer to <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsPkiBundle.html#qgis.core.QgsPkiBundle" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsPkiBundle</span></code></a> class documentation
to extract cert/key/CAs from the bundle.</p>
</section>
</section>
<section id="remove-an-entry-from-authdb">
<span id="remove-entry-from-authdb"></span><h3><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">14.3.3. </span>Remove an entry from authdb</a><a class="headerlink" href="#remove-an-entry-from-authdb" title="Link to this heading"></a></h3>
<p>We can remove an entry from <a class="reference internal" href="#term-Authentication-Database"><span class="xref std std-term">Authentication Database</span></a> using it’s
<code class="docutils literal notranslate"><span class="pre">authcfg</span></code> identifier with the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authMgr</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="n">authMgr</span><span class="o">.</span><span class="n">removeAuthenticationConfig</span><span class="p">(</span> <span class="s2">&quot;authCfg_Id_to_remove&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="leave-authcfg-expansion-to-qgsauthmanager">
<span id="id5"></span><h3><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">14.3.4. </span>Leave authcfg expansion to QgsAuthManager</a><a class="headerlink" href="#leave-authcfg-expansion-to-qgsauthmanager" title="Link to this heading"></a></h3>
<p>The best way to use an <a class="reference internal" href="#term-Authentication-Config"><span class="xref std std-term">Authentication Config</span></a> stored in the
<a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a> is referring it with the unique identifier
<code class="docutils literal notranslate"><span class="pre">authcfg</span></code>. Expanding, means convert it from an identifier to a complete
set of credentials.
The best practice to use stored <a class="reference internal" href="#term-Authentication-Config"><span class="xref std std-term">Authentication Config</span></a>s, is to leave it
managed automatically by the Authentication manager.
The common use of a stored configuration is to connect to an authentication
enabled service like a WMS or WFS or to a DB connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Take into account that not all QGIS data providers are integrated with the
Authentication infrastructure. Each authentication method, derived from the
base class <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthMethod.html#qgis.core.QgsAuthMethod" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthMethod</span></code></a>
and support a different set of Providers. For example the <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager.certIdentity" title="(in QGIS Python API v3.34)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">certIdentity()</span></code></a> method supports the following list
of providers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authM</span> <span class="o">=</span> <span class="n">QgsApplication</span><span class="o">.</span><span class="n">authManager</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">authM</span><span class="o">.</span><span class="n">authMethod</span><span class="p">(</span><span class="s2">&quot;Identity-Cert&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">supportedDataProviders</span><span class="p">())</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;ows&#39;, &#39;wfs&#39;, &#39;wcs&#39;, &#39;wms&#39;, &#39;postgres&#39;]
</pre></div>
</div>
</div>
<p>For example, to access a WMS service using stored credentials identified with
<code class="docutils literal notranslate"><span class="pre">authcfg</span> <span class="pre">=</span> <span class="pre">'fm1s770'</span></code>, we just have to use the <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> in the data source
URL like in the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">authCfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
<span class="linenos"> 2</span><span class="n">quri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">()</span>
<span class="linenos"> 3</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;layers&quot;</span><span class="p">,</span> <span class="s1">&#39;usa:states&#39;</span><span class="p">)</span>
<span class="linenos"> 4</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;styles&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="linenos"> 5</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span> <span class="s1">&#39;image/png&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;crs&quot;</span><span class="p">,</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;dpiMode&quot;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;featureCount&quot;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;authcfg&quot;</span><span class="p">,</span> <span class="n">authCfg</span><span class="p">)</span>   <span class="c1"># &lt;---- here my authCfg url parameter</span>
<span class="linenos">10</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;contextualWMSLegend&quot;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s1">&#39;https://my_auth_enabled_server_ip/wms&#39;</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">quri</span><span class="o">.</span><span class="n">encodedUri</span><span class="p">(),</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">),</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;wms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the upper case, the <code class="docutils literal notranslate"><span class="pre">wms</span></code> provider will take care to expand <code class="docutils literal notranslate"><span class="pre">authcfg</span></code>
URI parameter with credential just before setting the HTTP connection.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The developer would have to leave <code class="docutils literal notranslate"><span class="pre">authcfg</span></code> expansion to the <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsAuthManager.html#qgis.core.QgsAuthManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthManager</span></code></a>, in this way he will be sure that expansion is not done too early.</p>
</div>
<p>Usually an URI string, built using the <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsDataSourceUri.html#qgis.core.QgsDataSourceUri" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsDataSourceURI</span></code></a>
class, is used to set a data source in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">authCfg</span> <span class="o">=</span> <span class="s1">&#39;fm1s770&#39;</span>
<span class="n">quri</span> <span class="o">=</span> <span class="n">QgsDataSourceUri</span><span class="p">(</span><span class="s2">&quot;my WMS uri here&quot;</span><span class="p">)</span>
<span class="n">quri</span><span class="o">.</span><span class="n">setParam</span><span class="p">(</span><span class="s2">&quot;authcfg&quot;</span><span class="p">,</span> <span class="n">authCfg</span><span class="p">)</span>
<span class="n">rlayer</span> <span class="o">=</span> <span class="n">QgsRasterLayer</span><span class="p">(</span> <span class="n">quri</span><span class="o">.</span><span class="n">uri</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;wms&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">False</span></code> parameter is important to avoid URI complete expansion of the
<code class="docutils literal notranslate"><span class="pre">authcfg</span></code> id present in the URI.</p>
</div>
<section id="pki-examples-with-other-data-providers">
<span id="id6"></span><h4><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">14.3.4.1. </span>PKI examples with other data providers</a><a class="headerlink" href="#pki-examples-with-other-data-providers" title="Link to this heading"></a></h4>
<p>Other example can be read directly in the QGIS tests upstream as in
<a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_authmanager_pki_ows.py">test_authmanager_pki_ows</a> or
<a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_authmanager_pki_postgres.py">test_authmanager_pki_postgres</a>.</p>
</section>
</section>
</section>
<section id="adapt-plugins-to-use-authentication-infrastructure">
<span id="adapt-plugins-to-use-auth-infrastructure"></span><h2><a class="toc-backref" href="#id22" role="doc-backlink"><span class="section-number">14.4. </span>Adapt plugins to use Authentication infrastructure</a><a class="headerlink" href="#adapt-plugins-to-use-authentication-infrastructure" title="Link to this heading"></a></h2>
<p>Many third party plugins are using httplib2 or other Python networking libraries to manage HTTP
connections instead of integrating with <a class="reference external" href="https://qgis.org/pyqgis/3.34/core/QgsNetworkAccessManager.html#qgis.core.QgsNetworkAccessManager" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsNetworkAccessManager</span></code></a>
and its related Authentication Infrastructure integration.</p>
<p>To facilitate this integration a helper Python function has been created
called <code class="docutils literal notranslate"><span class="pre">NetworkAccessManager</span></code>. Its code can be found <a class="reference external" href="https://github.com/rduivenvoorde/pdokservicesplugin/blob/master/networkaccessmanager.py">here</a>.</p>
<p>This helper class can be used as in the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">http</span> <span class="o">=</span> <span class="n">NetworkAccessManager</span><span class="p">(</span><span class="n">authid</span><span class="o">=</span><span class="s2">&quot;my_authCfg&quot;</span><span class="p">,</span> <span class="n">exception_class</span><span class="o">=</span><span class="n">My_FailedRequestError</span><span class="p">)</span>
<span class="linenos">2</span><span class="k">try</span><span class="p">:</span>
<span class="linenos">3</span>  <span class="n">response</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">request</span><span class="p">(</span> <span class="s2">&quot;my_rest_url&quot;</span> <span class="p">)</span>
<span class="linenos">4</span><span class="k">except</span> <span class="n">My_FailedRequestError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
<span class="linenos">5</span>  <span class="c1"># Handle exception</span>
<span class="linenos">6</span>  <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="authentication-guis">
<span id="id7"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">14.5. </span>Authentication GUIs</a><a class="headerlink" href="#authentication-guis" title="Link to this heading"></a></h2>
<p>In this paragraph are listed the available GUIs useful to integrate
authentication infrastructure in custom interfaces.</p>
<section id="gui-to-select-credentials">
<span id="id8"></span><h3><a class="toc-backref" href="#id24" role="doc-backlink"><span class="section-number">14.5.1. </span>GUI to select credentials</a><a class="headerlink" href="#gui-to-select-credentials" title="Link to this heading"></a></h3>
<p>If it’s necessary to select a <a class="reference internal" href="#term-Authentication-Configuration"><span class="xref std std-term">Authentication Configuration</span></a> from the set
stored in the <a class="reference internal" href="#term-Authentication-DB"><span class="xref std std-term">Authentication DB</span></a> it is available in the GUI class
<a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthConfigSelect.html#qgis.gui.QgsAuthConfigSelect" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthConfigSelect</span></code></a>.</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthConfigSelect.png" src="../../_images/QgsAuthConfigSelect.png" />
</figure>
<p>and can be used as in the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthConfigSelect GUI hierarchically linked to</span>
<span class="linenos">2</span><span class="c1"># the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthConfigSelect</span><span class="p">(</span> <span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span> <span class="p">)</span>
<span class="linenos">5</span><span class="c1"># add the above created gui in a new tab of the interface where the</span>
<span class="linenos">6</span><span class="c1"># GUI has to be integrated</span>
<span class="linenos">7</span><span class="n">tabGui</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
<span class="linenos">8</span><span class="n">tabGui</span><span class="o">.</span><span class="n">insertTab</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gui</span><span class="p">,</span> <span class="s2">&quot;Configurations&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>The above example is taken from the QGIS source <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/src/providers/postgres/qgspgnewconnection.cpp#L42">code</a>.
The second parameter of the GUI constructor refers to data provider type. The
parameter is used to restrict the compatible <a class="reference internal" href="#term-Authentication-Method"><span class="xref std std-term">Authentication Method</span></a>s with
the specified provider.</p>
</section>
<section id="authentication-editor-gui">
<span id="id9"></span><h3><a class="toc-backref" href="#id25" role="doc-backlink"><span class="section-number">14.5.2. </span>Authentication Editor GUI</a><a class="headerlink" href="#authentication-editor-gui" title="Link to this heading"></a></h3>
<p>The complete GUI used to manage credentials, authorities and to access to
Authentication utilities is managed by the
<a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthEditorWidgets.html#qgis.gui.QgsAuthEditorWidgets" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthEditorWidgets</span></code></a> class.</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthEditorWidgets.png" src="../../_images/QgsAuthEditorWidgets.png" />
</figure>
<p>and can be used as in the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthEditorWidgets GUI hierarchically linked to</span>
<span class="linenos">2</span><span class="c1"># the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthConfigSelect</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
<span class="linenos">5</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>An integrated example can be found in the related <a class="reference external" href="https://github.com/qgis/QGIS/blob/release-3_34/tests/src/python/test_qgsauthsystem.py#L80">test</a>.</p>
</section>
<section id="authorities-editor-gui">
<span id="id10"></span><h3><a class="toc-backref" href="#id26" role="doc-backlink"><span class="section-number">14.5.3. </span>Authorities Editor GUI</a><a class="headerlink" href="#authorities-editor-gui" title="Link to this heading"></a></h3>
<p>A GUI used to manage only authorities is managed by the
<a class="reference external" href="https://qgis.org/pyqgis/3.34/gui/QgsAuthAuthoritiesEditor.html#qgis.gui.QgsAuthAuthoritiesEditor" title="(in QGIS Python API v3.34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QgsAuthAuthoritiesEditor</span></code></a> class.</p>
<figure class="align-center">
<img alt="../../_images/QgsAuthAuthoritiesEditor.png" src="../../_images/QgsAuthAuthoritiesEditor.png" />
</figure>
<p>and can be used as in the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># create the instance of the QgsAuthAuthoritiesEditor GUI hierarchically</span>
<span class="linenos">2</span><span class="c1">#  linked to the widget referred with `parent`</span>
<span class="linenos">3</span><span class="n">parent</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>  <span class="c1"># Your GUI parent widget</span>
<span class="linenos">4</span><span class="n">gui</span> <span class="o">=</span> <span class="n">QgsAuthAuthoritiesEditor</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
<span class="linenos">5</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="communicating.html" class="btn btn-neutral float-left" title="13. Communicating with the user" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tasks.html" class="btn btn-neutral float-right" title="15. Tasks - doing heavy work in the background" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2002-now, QGIS project.
      <span class="lastupdated">Last updated on 2024 May 30, 01:27 +0900.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Transifex follows a particular logic to build target pages:
Expected French translation link for https://docs.qgis.org/3.28/en/docs/user_manual/print_composer/overview_composer.html
would return https://app.transifex.com/qgis/qgis-documentation/translate/#fr/aa6d8bc653526d38b295ca94bf8eee5e
with the md5 value of "github#qgis/QGIS-Documentation#release_3.28#locale/en/LC_MESSAGES/docs/user_manual/print_composer/overview_composer.po"-->
<!--Make sure that mismatching language codes between Transifex and Sphinx are converted-->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-info-circle"> QGIS Documentation </span>
      v: 3.34
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
      <dl>
        <dt>Languages</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/en/docs/pyqgis_developer_cookbook/authentication.html">en</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/cs/docs/pyqgis_developer_cookbook/authentication.html">cs</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/de/docs/pyqgis_developer_cookbook/authentication.html">de</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/es/docs/pyqgis_developer_cookbook/authentication.html">es</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/fr/docs/pyqgis_developer_cookbook/authentication.html">fr</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/hu/docs/pyqgis_developer_cookbook/authentication.html">hu</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/it/docs/pyqgis_developer_cookbook/authentication.html">it</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ja/docs/pyqgis_developer_cookbook/authentication.html">ja</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ko/docs/pyqgis_developer_cookbook/authentication.html">ko</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/lt/docs/pyqgis_developer_cookbook/authentication.html">lt</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/nl/docs/pyqgis_developer_cookbook/authentication.html">nl</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_BR/docs/pyqgis_developer_cookbook/authentication.html">pt_BR</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/pt_PT/docs/pyqgis_developer_cookbook/authentication.html">pt_PT</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ro/docs/pyqgis_developer_cookbook/authentication.html">ro</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/ru/docs/pyqgis_developer_cookbook/authentication.html">ru</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zh-Hans/docs/pyqgis_developer_cookbook/authentication.html">zh-Hans</a></dd>
        
      </dl>

      <dl>
        <dt>Versions</dt>
        
          <dd><a href="https://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/authentication.html">testing</a></dd>
        
          <dd><a href="https://docs.qgis.org/latest/en/docs/pyqgis_developer_cookbook/authentication.html">latest</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/en/docs/pyqgis_developer_cookbook/authentication.html">3.34</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.28/en/docs/pyqgis_developer_cookbook/authentication.html">3.28</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.22/en/docs/pyqgis_developer_cookbook/authentication.html">3.22</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.16/en/docs/pyqgis_developer_cookbook/authentication.html">3.16</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.10/en/docs/pyqgis_developer_cookbook/authentication.html">3.10</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.4/en/docs/pyqgis_developer_cookbook/authentication.html">3.4</a></dd>
        
          <dd><a href="https://docs.qgis.org/2.18/en/docs/pyqgis_developer_cookbook/authentication.html">2.18</a></dd>
        
      </dl>

       
       <dl>
        <dt>Downloads</dt>
        
          <dd><a href="https://docs.qgis.org/3.34/pdf">PDF</a></dd>
        
          <dd><a href="https://docs.qgis.org/3.34/zip">HTML</a></dd>
        
      </dl>
      

      
       
      <dl>
        <dt>Contribute to Docs</dt>
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/edit/master/docs/pyqgis_developer_cookbook/authentication.rst" target="_blank" rel="noopener noreferrer">Edit on GitHub</a>
          </dd>
          
          
          <dd>
            <a href="https://app.transifex.com/qgis/qgis-documentation/translate/#en/29483b356636567227347a248f463599" target="_blank" rel="noopener noreferrer">Translate Page</a>
          </dd>
          
          <dd>
            <a href="https://github.com/qgis/QGIS-Documentation/issues" target="_blank" rel="noopener noreferrer">Report Issue</a>
          </dd>
      </dl>
      

      <dl>
        <dt>On QGIS Project</dt>
          <dd>
            <a href="https://qgis.org/en" target="_blank" rel="noopener noreferrer">Home</a>
          </dd>
          <dd>
            <a href="https://qgis.org/api/3.34" target="_blank" rel="noopener noreferrer">C++ API</a>
          </dd>
          <dd>
            <a href="https://qgis.org/pyqgis/3.34" target="_blank" rel="noopener noreferrer">PyQGIS API</a>
          </dd>
          <dd>
            <a href="https://github.com/qgis/QGIS/tree/release-3_34" target="_blank" rel="noopener noreferrer">Source</a>
          </dd>
      </dl>

    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>